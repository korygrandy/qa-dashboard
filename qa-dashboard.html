<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Applications - Automation Metrics Dashboard</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for a professional look */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
            scroll-behavior: smooth; /* Smooth scrolling for anchor links */
        }
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e0e0e0;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Hide update section and header links when printing */
        @media print {
            #update-data-section,
            .header-links {
                display: none !important;
            }
            body {
                background-color: #fff; /* White background for printing */
            }
            /* Adjust margins for print */
            .container.mx-auto {
                margin-left: 0;
                margin-right: 0;
                padding-left: 0;
                padding-right: 0;
            }
            /* Ensure content fits on page */
            section {
                box-shadow: none !important;
                border: none !important;
            }
            /* Force background colors to print for the progress bar */
            #overallAutomationProgressBar {
                -webkit-print-color-adjust: exact; /* For WebKit browsers like Chrome, Safari */
                color-adjust: exact; /* Standard property */
                print-color-adjust: exact; /* For Firefox */
            }
        }
        /* Spinner animation */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body id="top" class="bg-gray-100 text-gray-800">
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="bg-gradient-to-r from-blue-700 to-blue-900 text-white p-6 shadow-lg rounded-b-lg">
            <div class="container mx-auto flex justify-between items-center">
                <h1 class="text-3xl font-bold">Enterprise Applications</h1>
                <h2 class="text-2xl font-semibold">Automation Metrics Dashboard</h2>
            </div>
            <!-- Links and Print Icon -->
            <div class="container mx-auto mt-4 text-center flex justify-center items-center space-x-4 header-links">
                <a href="#update-data-section" class="inline-block bg-white text-blue-700 px-5 py-2 rounded-lg font-semibold shadow-md hover:bg-blue-100 transition duration-200">
                    Update Dashboard Data
                </a>
                <button onclick="window.print()" class="inline-flex items-center bg-white text-blue-700 px-5 py-2 rounded-lg font-semibold shadow-md hover:bg-blue-100 transition duration-200">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m0 0l3 3m-3-3l-3 3m3-3v-3a2 2 0 012-2h4a2 2 0 012 2v3m0 0l3 3m-3-3l-3 3m-3-3v-3a2 2 0 012-2h4a2 2 0 012 2v3"></path>
                    </svg>
                    Print Dashboard
                </button>
                <!-- Export as CSV Button (Commented Out) -->
                <!--
                <button id="exportCsvBtn" class="inline-flex items-center bg-white text-blue-700 px-5 py-2 rounded-lg font-semibold shadow-md hover:bg-blue-100 transition duration-200">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    Export as CSV
                </button>
                -->
                <!-- Export as JSON Button (Commented Out) -->
                <!--
                <button id="exportJsonBtn" class="inline-flex items-center bg-white text-blue-700 px-5 py-2 rounded-lg font-semibold shadow-md hover:bg-blue-100 transition duration-200">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
                    </svg>
                    Export as JSON
                </button>
                -->
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="flex-grow container mx-auto p-6 space-y-8">

            <!-- Section: Automation Coverage (Overall) -->
            <section class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">Overall Automation Coverage</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Current Automated Tests Card -->
                    <div class="bg-purple-50 p-6 rounded-lg shadow-sm border border-purple-200">
                        <h4 class="text-xl font-medium text-purple-800 mb-2">Total Tests Currently Automated</h4>
                        <p id="currentAutomatedCount" class="text-5xl font-extrabold text-purple-700">0</p>
                        <p class="text-gray-600 mt-2">Sum of tests automated across all categories.</p>
                    </div>
                    <!-- Planned Automation Card -->
                    <div class="bg-orange-50 p-6 rounded-lg shadow-sm border border-orange-200">
                        <h4 class="text-xl font-medium text-orange-800 mb-2">Tests Planned for Automation (Overall)</h4>
                        <p id="plannedAutomationCount" class="text-5xl font-extrabold text-orange-700">0</p>
                        <p class="text-gray-600 mt-2">Total tests targeted for automation across all categories.</p>
                    </div>
                </div>
                <div class="mt-6">
                    <h4 class="text-xl font-medium text-gray-800 mb-2">Overall Automation Progress</h4>
                    <div class="w-full bg-gray-200 rounded-full h-4">
                        <div id="overallAutomationProgressBar" class="bg-purple-600 h-4 rounded-full" style="width: 0%;"></div>
                    </div>
                    <p id="overallAutomationProgressText" class="text-right text-sm text-gray-600 mt-1">0% Automated</p>
                    <!-- Warning for automated > planned -->
                    <div id="overallAutomationWarning" class="mt-2 text-red-600 font-semibold text-sm hidden">
                        Warning: Total Automated Tests exceed Tests Planned for Automation. Please verify data.
                    </div>
                </div>
            </section>

            <!-- Section: Automation Coverage by Testing Team -->
            <section class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">Automation Coverage by Testing Team</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">

                    <!-- CRM Team Card (Previously CSM) -->
                    <div id="crmCard" class="test-type-card p-5 rounded-lg shadow-sm border">
                        <h4 class="text-xl font-medium text-gray-800 mb-3">CRM Team</h4>
                        <div class="space-y-1">
                            <p class="text-gray-700">Total Tests in Category: <span id="crmTotal" class="font-semibold">0</span></p>
                            <p class="text-indigo-600">Planned to Automate: <span id="crmPlannedToAutomate" class="font-semibold">0</span></p>
                            <p class="text-blue-600">Tests Automated: <span id="crmAutomated" class="font-semibold">0</span></p>
                            <div class="mt-2">
                                <h5 class="text-md font-medium text-gray-800 mb-1">
                                    <a href="#" class="toggle-breakdown-link text-blue-600 hover:underline text-sm" data-target="crmTestTypeBreakdownContent">
                                        Hide Breakdown by Test Type
                                    </a>
                                </h5>
                                <div id="crmTestTypeBreakdownContent" class="space-y-1 text-sm">
                                    <div id="crmTestTypeBreakdown">
                                        <!-- Test type details will be populated here by JavaScript -->
                                    </div>
                                </div>
                                <div id="crmRollupWarning" class="mt-2 text-red-600 font-semibold text-xs hidden">
                                    Warning: Sum of automated test types does not match team's total automated.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Imaging Team Card -->
                    <div id="imagingCard" class="test-type-card p-5 rounded-lg shadow-sm border">
                        <h4 class="text-xl font-medium text-gray-800 mb-3">Imaging Team</h4>
                        <div class="space-y-1">
                            <p class="text-gray-700">Total Tests in Category: <span id="imagingTotal" class="font-semibold">0</span></p>
                            <p class="text-indigo-600">Planned to Automate: <span id="imagingPlannedToAutomate" class="font-semibold">0</span></p>
                            <p class="text-blue-600">Tests Automated: <span id="imagingAutomated" class="font-semibold">0</span></p>
                            <div class="mt-2">
                                <h5 class="text-md font-medium text-gray-800 mb-1">
                                    <a href="#" class="toggle-breakdown-link text-blue-600 hover:underline text-sm" data-target="imagingTestTypeBreakdownContent">
                                        Hide Breakdown by Test Type
                                    </a>
                                </h5>
                                <div id="imagingTestTypeBreakdownContent" class="space-y-1 text-sm">
                                    <div id="imagingTestTypeBreakdown">
                                        <!-- Test type details will be populated here by JavaScript -->
                                    </div>
                                </div>
                                <div id="imagingRollupWarning" class="mt-2 text-red-600 font-semibold text-xs hidden">
                                    Warning: Sum of automated test types does not match team's total automated.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Phoenix Team Card -->
                    <div id="phoenixCard" class="test-type-card p-5 rounded-lg shadow-sm border">
                        <h4 class="text-xl font-medium text-gray-800 mb-3">Phoenix Team</h4>
                        <div class="space-y-1">
                            <p class="text-gray-700">Total Tests in Category: <span id="phoenixTotal" class="font-semibold">0</span></p>
                            <p class="text-indigo-600">Planned to Automate: <span id="phoenixPlannedToAutomate" class="font-semibold">0</span></p>
                            <p class="text-blue-600">Tests Automated: <span id="phoenixAutomated" class="font-semibold">0</span></p>
                            <div class="mt-2">
                                <h5 class="text-md font-medium text-gray-800 mb-1">
                                    <a href="#" class="toggle-breakdown-link text-blue-600 hover:underline text-sm" data-target="phoenixTestTypeBreakdownContent">
                                        Hide Breakdown by Test Type
                                    </a>
                                </h5>
                                <div id="phoenixTestTypeBreakdownContent" class="space-y-1 text-sm">
                                    <div id="phoenixTestTypeBreakdown">
                                        <!-- Test type details will be populated here by JavaScript -->
                                    </div>
                                </div>
                                <div id="phoenixRollupWarning" class="mt-2 text-red-600 font-semibold text-xs hidden">
                                    Warning: Sum of automated test types does not match team's total automated.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Ace Team Card -->
                    <div id="aceCard" class="test-type-card p-5 rounded-lg shadow-sm border">
                        <h4 class="text-xl font-medium text-gray-800 mb-3">Ace Team</h4>
                        <div class="space-y-1">
                            <p class="text-gray-700">Total Tests in Category: <span id="aceTotal" class="font-semibold">0</span></p>
                            <p class="text-indigo-600">Planned to Automate: <span id="acePlannedToAutomate" class="font-semibold">0</span></p>
                            <p class="text-blue-600">Tests Automated: <span id="aceAutomated" class="font-semibold">0</span></p>
                            <div class="mt-2">
                                <h5 class="text-md font-medium text-gray-800 mb-1">
                                    <a href="#" class="toggle-breakdown-link text-blue-600 hover:underline text-sm" data-target="aceTestTypeBreakdownContent">
                                        Hide Breakdown by Test Type
                                    </a>
                                </h5>
                                <div id="aceTestTypeBreakdownContent" class="space-y-1 text-sm">
                                    <div id="aceTestTypeBreakdown">
                                        <!-- Test type details will be populated here by JavaScript -->
                                    </div>
                                </div>
                                <div id="aceRollupWarning" class="mt-2 text-red-600 font-semibold text-xs hidden">
                                    Warning: Sum of automated test types does not match team's total automated.
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </section>

            <!-- Section: How to Use This Dashboard -->
            <section class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">How to Use This Dashboard</h3>
                <p class="text-gray-700 mb-4">
                    This dashboard provides a high-level overview of our Quality Assurance (QA) testing metrics.
                </p>

                <h4 class="text-xl font-medium text-gray-800 mb-2">1. Overall Automation Coverage:</h4>
                <ul class="list-disc list-inside text-gray-700 space-y-1 mb-4">
                    <li>**Total Tests Currently Automated vs. Planned:** High-level view of all automation efforts.</li>
                    <li>**Overall Automation Progress Bar:** Visual indicator of automation completion.
                        <ul class="list-circle list-inside ml-4">
                            <li><span class="font-semibold text-green-700">Green:</span> > 80% Automated.</li>
                            <li><span class="font-semibold text-yellow-600">Yellow:</span> > 60% &lt;= 80% Automated.</li>
                            <li><span class="font-semibold text-red-600">Red:</span> &lt;= 60% Automated.</li>
                        </ul>
                    </li>
                </ul>

                <h4 class="text-xl font-medium text-gray-800 mb-2">2. Automation Coverage by Testing Team:</h4>
                <ul class="list-disc list-inside text-gray-700 space-y-1 mb-4">
                    <li>For each team (CRM, Imaging, Phoenix, Ace), you'll see:
                        <ul class="list-circle list-inside ml-4">
                            <li>**Total Tests, Planned to Automate, Tests Automated:** Key metrics for the team.</li>
                            <li>**Automation Progress Bar:** Visual progress for the team.</li>
                            <li>**Breakdown by Test Type:** Detailed progress for Unit, Functional, API tests, etc., within each team, including individual progress bars.</li>
                            <li>**Roll-up Warning:** Appears if the sum of individual test types' automated counts doesn't match the team's overall "Tests Automated" from CSV.</li>
                        </ul>
                    </li>
                    <li>**Team Card Color Coding:**
                        <ul class="list-circle list-inside ml-4">
                            <li><span class="font-semibold text-green-700">Green Background:</span> > 80% automation coverage.</li>
                            <li><span class="font-semibold text-yellow-700">Yellow Background:</span> > 50% but &lt;= 80% automation coverage.</li>
                            <li><span class="font-semibold text-red-700">Red Background:</span> &lt;= 50% automation coverage.</li>
                        </ul>
                    </li>
                </ul>

                <h4 class="text-xl font-medium text-gray-800 mb-2">3. Updating the Data:</h4>
                <p class="text-gray-700 mb-2">
                    Update data by pasting CSV content directly into the text area below.
                </p>
                <ul class="list-disc list-inside text-gray-700 space-y-1 mb-4">
                    <li>**CSV Format:** Two columns: <code class="font-mono text-sm bg-gray-200 p-1 rounded">Metric</code> and <code class="font-mono text-sm bg-gray-200 p-1 rounded">Value</code>.</li>
                    <li>**Data Structure:** Include specific metrics for each team and test type (e.g., `CRM_Unit_Automated`). The team's `_Automated` value should be the sum of its test types.</li>
                    <li>**Process:** Copy CSV from a text editor, paste into the text area, and click "Load Data."</li>
                </ul>
                <p class="text-gray-700">
                    This dashboard is a living document for monitoring QA health and identifying risks.
                </p>
            </section>

            <!-- Section: Understanding the Overall Automation Warning -->
            <section class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">Understanding the Overall Automation Warning</h3>
                <p class="text-gray-700 mb-4">
                    The <span class="text-red-600">red</span> warning message, "Warning: Total Automated Tests exceed Tests Planned for Automation. Please verify data," highlights potential data inconsistency.
                </p>

                <h4 class="text-xl font-medium text-gray-800 mb-2">What it means:</h4>
                <p class="text-gray-700 mb-2">
                    Automated tests should not exceed planned tests. This warning appears if total automated tests (sum of all team/type automated counts) are higher than the overall "Tests Planned for Automation."
                </p>

                <h4 class="text-xl font-medium text-gray-800 mb-2">Why it might appear:</h4>
                <ul class="list-disc list-inside text-gray-700 space-y-1 mb-4">
                    <li>**Data Entry Error:** Most common reason is a typo in your CSV data.</li>
                    <li>**Unexpected Automation:** More tests automated than planned, requiring a review to update the "Planned to Automate" metric.</li>
                </ul>

                <h4 class="text-xl font-medium text-gray-800 mb-2">What to do if you see it:</h4>
                <ul class="list-disc list-inside text-gray-700 space-y-1 mb-4">
                    <li>**Review CSV data:** Double-check all "Tests Automated" and "PlannedToAutomate" values for logical alignment.</li>
                    <li>**Adjust "Planned" if necessary:** Update the overall "PlannedToAutomate" value to reflect new targets if more tests were genuinely automated.</li>
                </ul>
                <p class="text-gray-700">
                    This warning helps maintain data integrity and accurate reporting.
                </p>
            </section>

            <!-- Section: Update Data via CSV (Moved to bottom) -->
            <section id="update-data-section" class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">Update Data via CSV</h3>
                <p class="text-gray-700 mb-4">
                    You can update the dashboard data by pasting CSV content from your Excel file below.
                    Ensure your CSV has two columns: <code class="font-mono text-sm bg-gray-200 p-1 rounded">Metric</code> and <code class="font-mono text-sm bg-gray-200 p-1 rounded">Value</code>.
                </p>
                <p class="text-gray-700 mb-4">
                    Below is sample data you can copy and paste into the text area to see how the dashboard works with different values and color shadings.
                </p>
                <div class="relative mb-4">
                    <pre id="csvExampleData" class="bg-gray-100 p-2 rounded text-sm overflow-auto pr-10"><code>Metric,Value
PlannedToAutomate,880
CRM_Total,200
CRM_PlannedToAutomate,180
CRM_Automated,117
CRM_Unit_Total,40
CRM_Unit_PlannedToAutomate,35
CRM_Unit_Automated,20
CRM_Functional_Total,50
CRM_Functional_PlannedToAutomate,45
CRM_Functional_Automated,30
CRM_IncrementalDataLoad_Total,20
CRM_IncrementalDataLoad_PlannedToAutomate,18
CRM_IncrementalDataLoad_Automated,17
CRM_FullLoadDataValidation_Total,30
CRM_FullLoadDataValidation_PlannedToAutomate,28
CRM_FullLoadDataValidation_Automated,12
CRM_UserAcceptance_Total,20
CRM_UserAcceptance_PlannedToAutomate,18
CRM_UserAcceptance_Automated,14
CRM_API_Total,15
CRM_API_PlannedToAutomate,14
CRM_API_Automated,13
CRM_Regression_Total,15
CRM_Regression_PlannedToAutomate,14
CRM_Regression_Automated,5
CRM_Smoke_Total,10
CRM_Smoke_PlannedToAutomate,8
CRM_Smoke_Automated,6
Imaging_Total,300
Imaging_PlannedToAutomate,280
Imaging_Automated,238
Imaging_Unit_Total,60
Imaging_Unit_PlannedToAutomate,55
Imaging_Unit_Automated,52
Imaging_Functional_Total,80
Imaging_Functional_PlannedToAutomate,75
Imaging_Functional_Automated,55
Imaging_IncrementalDataLoad_Total,30
Imaging_IncrementalDataLoad_PlannedToAutomate,28
Imaging_IncrementalDataLoad_Automated,20
Imaging_FullLoadDataValidation_Total,40
Imaging_FullLoadDataValidation_PlannedToAutomate,38
Imaging_FullLoadDataValidation_Automated,36
Imaging_UserAcceptance_Total,30
Imaging_UserAcceptance_PlannedToAutomate,28
Imaging_UserAcceptance_Automated,18
Imaging_API_Total,20
Imaging_API_PlannedToAutomate,18
Imaging_API_Automated,17
Imaging_Regression_Total,20
Imaging_Regression_PlannedToAutomate,18
Imaging_Regression_Automated,17
Imaging_Smoke_Total,20
Imaging_Smoke_PlannedToAutomate,20
Imaging_Smoke_Automated,23
Phoenix_Total,250
Phoenix_PlannedToAutomate,220
Phoenix_Automated,163
Phoenix_Unit_Total,50
Phoenix_Unit_PlannedToAutomate,45
Phoenix_Unit_Automated,30
Phoenix_Functional_Total,70
Phoenix_Functional_PlannedToAutomate,65
Phoenix_Functional_Automated,60
Phoenix_IncrementalDataLoad_Total,25
Phoenix_IncrementalDataLoad_PlannedToAutomate,22
Phoenix_IncrementalDataLoad_Automated,10
Phoenix_FullLoadDataValidation_Total,35
Phoenix_FullLoadDataValidation_PlannedToAutomate,32
Phoenix_FullLoadDataValidation_Automated,20
Phoenix_UserAcceptance_Total,25
Phoenix_UserAcceptance_PlannedToAutomate,22
Phoenix_UserAcceptance_Automated,20
Phoenix_API_Total,15
Phoenix_API_PlannedToAutomate,13
Phoenix_API_Automated,5
Phoenix_Regression_Total,15
Phoenix_Regression_PlannedToAutomate,13
Phoenix_Regression_Automated,8
Phoenix_Smoke_Total,15
Phoenix_Smoke_PlannedToAutomate,15
Phoenix_Smoke_Automated,10
Ace_Total,250
Ace_PlannedToAutomate,200
Ace_Automated,90
Ace_Unit_Total,50
Ace_Unit_PlannedToAutomate,40
Ace_Unit_Automated,15
Ace_Functional_Total,70
Ace_Functional_PlannedToAutomate,60
Ace_Functional_Automated,25
Ace_IncrementalDataLoad_Total,25
Ace_IncrementalDataLoad_PlannedToAutomate,20
Ace_IncrementalDataLoad_Automated,13
Ace_FullLoadDataValidation_Total,35
Ace_FullLoadDataValidation_PlannedToAutomate,30
Ace_FullLoadDataValidation_Automated,10
Ace_UserAcceptance_Total,25
Ace_UserAcceptance_PlannedToAutomate,20
Ace_UserAcceptance_Automated,8
Ace_API_Total,15
Ace_API_PlannedToAutomate,10
Ace_API_Automated,9
Ace_Regression_Total,15
Ace_Regression_PlannedToAutomate,10
Ace_Regression_Automated,4
Ace_Smoke_Total,15
Ace_Smoke_PlannedToAutomate,10
Ace_Smoke_Automated,6
</code></pre>
                    <span id="copyConfirmMessage" class="absolute top-2 right-16 text-xs text-green-600 hidden">Copied!</span>
                </div>
                <a href="#" id="copyCsvExampleLink" class="inline-block text-blue-600 hover:text-blue-800 text-sm font-semibold mb-2 transition duration-200">
                    Copy Sample Data
                </a>
                <p class="text-sm text-gray-600 mb-4">
                    To export from Excel: Go to File > Save As > Browse, then select "CSV (Comma delimited) (*.csv)" from the "Save as type" dropdown. Open the .csv file with a simple text editor and copy its content.
                </p>
                <textarea id="csvInput" rows="10" class="w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 font-mono text-sm" placeholder="Paste your CSV data here..."></textarea>
                <div class="mt-4 flex items-center space-x-4">
                    <button id="loadDataBtn" class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200">
                        Load Data
                    </button>
                    <a href="#top" class="inline-block px-6 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition duration-200">
                        Back to Top
                    </a>
                </div>
                <p id="dataLoadMessage" class="mt-2 text-sm text-red-600 hidden"></p>
            </section>

            <!-- Section: Developer Readme -->
            <section class="bg-white p-6 rounded-lg shadow-md">
                <h3 id="developerReadmeHeading" class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">
                    Developer Readme
                </h3>
                <div id="developerReadmeContent">
                    <p class="text-gray-700 mb-4">
                        This section provides instructions for developers or advanced users who wish to modify the dashboard's default data loading behavior.
                    </p>

                    <h4 class="text-xl font-medium text-gray-800 mb-2">Data Loading Configuration:</h4>
                    <p class="text-gray-700 mb-2">
                        The dashboard can be configured to load data automatically from a hardcoded string when the page loads, or to rely on random default data until the user manually loads data via the CSV input.
                    </p>
                    <ul class="list-disc list-inside text-gray-700 space-y-2 mb-4">
                        <li>
                            To control this behavior, locate the following JavaScript constant at the top of the `&lt;script&gt;` block:
                            <pre class="bg-gray-100 p-2 rounded text-sm mt-1 mb-1 overflow-auto"><code>const LOAD_FROM_HARDCODED_ON_STARTUP = true;</code></pre>
                            <ul>
                                <li>Set `true`: The dashboard will load data from the `HARDCODED_CSV_DATA` string immediately upon page load.</li>
                                <li>Set `false`: The dashboard will load random data initially. The "Update Data via CSV" section will then be the primary way to input data.</li>
                            </ul>
                        </li>
                        <li>
                            To modify the hardcoded data, edit the `HARDCODED_CSV_DATA` multiline string constant:
                            <pre class="bg-gray-100 p-2 rounded text-sm mt-1 mb-1 overflow-auto"><code>const HARDCODED_CSV_DATA = `Metric,Value
... your CSV data here ...
`;</code></pre>
                            <p class="text-sm text-gray-600 mt-1">
                                Ensure the CSV format matches the example provided in the "Update Data via CSV" section.
                                Remember, direct file system access (e.g., `C:\temp\rawdata.csv`) is not possible due to browser security policies.
                            </p>
                        </li>
                    </ul>

                    <h4 class="text-xl font-medium text-gray-800 mb-2 mt-6">Regression Test Scenarios:</h4>
                    <p class="text-gray-700 mb-4">
                        Use the following scenarios to validate the dashboard's logic and calculations. Copy the CSV data and paste it into the "Update Data via CSV" text area to test each case.
                    </p>

                    <div class="mb-8">
                        <h5 class="text-lg font-semibold text-gray-900 mb-2">Scenario 1: All Green (High Automation Across the Board)</h5>
                        <p class="text-gray-700 mb-2">This scenario aims for high automation percentages for all teams and test types, resulting in a generally "green" dashboard.</p>
                        <h6 class="text-md font-medium text-gray-800 mb-1">CSV Data:</h6>
                        <pre id="scenario1CsvData" class="bg-gray-100 p-2 rounded text-sm overflow-auto mb-2"><code>Metric,Value
PlannedToAutomate,1000
CRM_Total,200
CRM_PlannedToAutomate,180
CRM_Automated,170
CRM_Unit_Total,40
CRM_Unit_PlannedToAutomate,35
CRM_Unit_Automated,34
CRM_Functional_Total,50
CRM_Functional_PlannedToAutomate,45
CRM_Functional_Automated,42
CRM_IncrementalDataLoad_Total,20
CRM_IncrementalDataLoad_PlannedToAutomate,18
CRM_IncrementalDataLoad_Automated,17
CRM_FullLoadDataValidation_Total,30
CRM_FullLoadDataValidation_PlannedToAutomate,28
CRM_FullLoadDataValidation_Automated,26
CRM_UserAcceptance_Total,20
CRM_UserAcceptance_PlannedToAutomate,18
CRM_UserAcceptance_Automated,17
CRM_API_Total,15
CRM_API_PlannedToAutomate,14
CRM_API_Automated,13
CRM_Regression_Total,15
CRM_Regression_PlannedToAutomate,14
CRM_Regression_Automated,13
CRM_Smoke_Total,10
CRM_Smoke_PlannedToAutomate,8
CRM_Smoke_Automated,8
Imaging_Total,300
Imaging_PlannedToAutomate,280
Imaging_Automated,260
Imaging_Unit_Total,60
Imaging_Unit_PlannedToAutomate,55
Imaging_Unit_Automated,52
Imaging_Functional_Total,80
Imaging_Functional_PlannedToAutomate,75
Imaging_Functional_Automated,70
Imaging_IncrementalDataLoad_Total,30
Imaging_IncrementalDataLoad_PlannedToAutomate,28
Imaging_IncrementalDataLoad_Automated,26
Imaging_FullLoadDataValidation_Total,40
Imaging_FullLoadDataValidation_PlannedToAutomate,38
Imaging_FullLoadDataValidation_Automated,36
Imaging_UserAcceptance_Total,30
Imaging_UserAcceptance_PlannedToAutomate,28
Imaging_UserAcceptance_Automated,26
Imaging_API_Total,20
Imaging_API_PlannedToAutomate,18
Imaging_API_Automated,17
Imaging_Regression_Total,20
Imaging_Regression_PlannedToAutomate,18
Imaging_Regression_Automated,17
Imaging_Smoke_Total,20
Imaging_Smoke_PlannedToAutomate,20
Imaging_Smoke_Automated,16
Phoenix_Total,250
Phoenix_PlannedToAutomate,220
Phoenix_Automated,200
Phoenix_Unit_Total,50
Phoenix_Unit_PlannedToAutomate,45
Phoenix_Unit_Automated,40
Phoenix_Functional_Total,70
Phoenix_Functional_PlannedToAutomate,65
Phoenix_Functional_Automated,60
Phoenix_IncrementalDataLoad_Total,25
Phoenix_IncrementalDataLoad_PlannedToAutomate,22
Phoenix_IncrementalDataLoad_Automated,20
Phoenix_FullLoadDataValidation_Total,35
Phoenix_FullLoadDataValidation_PlannedToAutomate,32
Phoenix_FullLoadDataValidation_Automated,28
Phoenix_UserAcceptance_Total,25
Phoenix_UserAcceptance_PlannedToAutomate,22
Phoenix_UserAcceptance_Automated,20
Phoenix_API_Total,15
Phoenix_API_PlannedToAutomate,13
Phoenix_API_Automated,12
Phoenix_Regression_Total,15
Phoenix_Regression_PlannedToAutomate,13
Phoenix_Regression_Automated,10
Phoenix_Smoke_Total,15
Phoenix_Smoke_PlannedToAutomate,8
Phoenix_Smoke_Automated,10
Ace_Total,250
Ace_PlannedToAutomate,200
Ace_Automated,180
Ace_Unit_Total,50
Ace_Unit_PlannedToAutomate,40
Ace_Unit_Automated,38
Ace_Functional_Total,70
Ace_Functional_PlannedToAutomate,60
Ace_Functional_Automated,55
Ace_IncrementalDataLoad_Total,25
Ace_IncrementalDataLoad_PlannedToAutomate,20
Ace_IncrementalDataLoad_Automated,18
Ace_FullLoadDataValidation_Total,35
Ace_FullLoadDataValidation_PlannedToAutomate,30
Ace_FullLoadDataValidation_Automated,27
Ace_UserAcceptance_Total,25
Ace_UserAcceptance_PlannedToAutomate,20
Ace_UserAcceptance_Automated,18
Ace_API_Total,15
Ace_API_PlannedToAutomate,10
Ace_API_Automated,9
Ace_Regression_Total,15
Ace_Regression_PlannedToAutomate,10
Ace_Regression_Automated,8
Ace_Smoke_Total,15
Ace_Smoke_PlannedToAutomate,10
Ace_Smoke_Automated,7
</code></pre>
                        <div class="flex items-center space-x-4 mt-2">
                            <a href="#" class="copy-scenario-data inline-block text-blue-600 hover:text-blue-800 text-sm font-semibold transition duration-200" data-scenario-id="scenario1CsvData">
                                Copy CSV Data
                            </a>
                            <button class="load-scenario-data px-4 py-1 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-200 text-sm" data-scenario-id="scenario1CsvData">
                                Load CSV Data
                            </button>
                            <span id="scenario1ConfirmMessage" class="text-xs text-green-600 hidden">Copied/Loaded!</span>
                        </div>
                        <h6 class="text-md font-medium text-gray-800 mb-1 mt-4">Expected Outcomes:</h6>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 ml-4">
                            <li>**Overall Automation Coverage:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests Currently Automated: **810**</li>
                                    <li>Tests Planned for Automation (Overall): **1000**</li>
                                    <li>Overall Automation Progress: **81.0% (Green bar)**</li>
                                    <li>Overall Automation Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**CRM Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **170** (Calculated sum matches CSV)</li>
                                    <li>Planned to Automate: **180**</li>
                                    <li>Automation Progress: **94.4% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Imaging Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **260** (Calculated sum matches CSV)</li>
                                    <li>Planned to Automate: **280**</li>
                                    <li>Automation Progress: **92.9% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Phoenix Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **200** (Calculated sum matches CSV)</li>
                                    <li>Planned to Automate: **220**</li>
                                    <li>Automation Progress: **90.9% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Ace Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **180** (Calculated sum matches CSV)</li>
                                    <li>Planned to Automate: **200**</li>
                                    <li>Automation Progress: **90.0% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div class="mb-8">
                        <h5 class="text-lg font-semibold text-gray-900 mb-2">Scenario 2: Mixed Coverage (Green, Yellow, Red)</h5>
                        <p class="text-gray-700 mb-2">This scenario introduces varying levels of automation to see how the color coding and progress bars respond.</p>
                        <h6 class="text-md font-medium text-gray-800 mb-1">CSV Data:</h6>
                        <pre id="scenario2CsvData" class="bg-gray-100 p-2 rounded text-sm overflow-auto mb-2"><code>Metric,Value
PlannedToAutomate,1200
CRM_Total,200
CRM_PlannedToAutomate,180
CRM_Automated,100
CRM_Unit_Total,40
CRM_Unit_PlannedToAutomate,35
CRM_Unit_Automated,20
CRM_Functional_Total,50
CRM_Functional_PlannedToAutomate,45
CRM_Functional_Automated,25
CRM_IncrementalDataLoad_Total,20
CRM_IncrementalDataLoad_PlannedToAutomate,18
CRM_IncrementalDataLoad_Automated,10
CRM_FullLoadDataValidation_Total,30
CRM_FullLoadDataValidation_PlannedToAutomate,28
CRM_FullLoadDataValidation_Automated,15
CRM_UserAcceptance_Total,20
CRM_UserAcceptance_PlannedToAutomate,18
CRM_UserAcceptance_Automated,10
CRM_API_Total,15
CRM_API_PlannedToAutomate,14
CRM_API_Automated,8
CRM_Regression_Total,15
CRM_Regression_PlannedToAutomate,14
CRM_Regression_Automated,7
CRM_Smoke_Total,10
CRM_Smoke_PlannedToAutomate,8
CRM_Smoke_Automated,5
Imaging_Total,300
Imaging_PlannedToAutomate,280
Imaging_Automated,260
Imaging_Unit_Total,60
Imaging_Unit_PlannedToAutomate,55
Imaging_Unit_Automated,52
Imaging_Functional_Total,80
Imaging_Functional_PlannedToAutomate,75
Imaging_Functional_Automated,70
Imaging_IncrementalDataLoad_Total,30
Imaging_IncrementalDataLoad_PlannedToAutomate,28
Imaging_IncrementalDataLoad_Automated,26
Imaging_FullLoadDataValidation_Total,40
Imaging_FullLoadDataValidation_PlannedToAutomate,38
Imaging_FullLoadDataValidation_Automated,36
Imaging_UserAcceptance_Total,30
Imaging_UserAcceptance_PlannedToAutomate,28
Imaging_UserAcceptance_Automated,26
Imaging_API_Total,20
Imaging_API_PlannedToAutomate,18
Imaging_API_Automated,17
Imaging_Regression_Total,20
Imaging_Regression_PlannedToAutomate,18
Imaging_Regression_Automated,17
Imaging_Smoke_Total,20
Imaging_Smoke_PlannedToAutomate,20
Imaging_Smoke_Automated,16
Phoenix_Total,250
Phoenix_PlannedToAutomate,220
Phoenix_Automated,130
Phoenix_Unit_Total,50
Phoenix_Unit_PlannedToAutomate,45
Phoenix_Unit_Automated,25
Phoenix_Functional_Total,70
Phoenix_Functional_PlannedToAutomate,65
Phoenix_Functional_Automated,35
Phoenix_IncrementalDataLoad_Total,25
Phoenix_IncrementalDataLoad_PlannedToAutomate,22
Phoenix_IncrementalDataLoad_Automated,12
Phoenix_FullLoadDataValidation_Total,35
Phoenix_FullLoadDataValidation_PlannedToAutomate,32
Phoenix_FullLoadDataValidation_Automated,18
Phoenix_UserAcceptance_Total,25
Phoenix_UserAcceptance_PlannedToAutomate,22
Phoenix_UserAcceptance_Automated,12
Phoenix_API_Total,15
Phoenix_API_PlannedToAutomate,13
Phoenix_API_Automated,7
Phoenix_Regression_Total,15
Phoenix_Regression_PlannedToAutomate,13
Phoenix_Regression_Automated,7
Phoenix_Smoke_Total,15
Phoenix_Smoke_PlannedToAutomate,8
Phoenix_Smoke_Automated,14
Ace_Total,250
Ace_PlannedToAutomate,200
Ace_Automated,100
Ace_Unit_Total,50
Ace_Unit_PlannedToAutomate,40
Ace_Unit_Automated,20
Ace_Functional_Total,70
Ace_Functional_PlannedToAutomate,60
Ace_Functional_Automated,30
Ace_IncrementalDataLoad_Total,25
Ace_IncrementalDataLoad_PlannedToAutomate,20
Ace_IncrementalDataLoad_Automated,10
Ace_FullLoadDataValidation_Total,35
Ace_FullLoadDataValidation_PlannedToAutomate,30
Ace_FullLoadDataValidation_Automated,15
Ace_UserAcceptance_Total,25
Ace_UserAcceptance_PlannedToAutomate,20
Ace_UserAcceptance_Automated,10
Ace_API_Total,15
Ace_API_PlannedToAutomate,10
Ace_API_Automated,5
Ace_Regression_Total,15
Ace_Regression_PlannedToAutomate,10
Ace_Regression_Automated,5
Ace_Smoke_Total,15
Ace_Smoke_PlannedToAutomate,10
Ace_Smoke_Automated,5
</code></pre>
                        <div class="flex items-center space-x-4 mt-2">
                            <a href="#" class="copy-scenario-data inline-block text-blue-600 hover:text-blue-800 text-sm font-semibold transition duration-200" data-scenario-id="scenario2CsvData">
                                Copy CSV Data
                            </a>
                            <button class="load-scenario-data px-4 py-1 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-200 text-sm" data-scenario-id="scenario2CsvData">
                                Load CSV Data
                            </button>
                            <span id="scenario2ConfirmMessage" class="text-xs text-green-600 hidden">Copied/Loaded!</span>
                        </div>
                        <h6 class="text-md font-medium text-gray-800 mb-1 mt-4">Expected Outcomes:</h6>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 ml-4">
                            <li>**Overall Automation Coverage:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests Currently Automated: **590**</li>
                                    <li>Tests Planned for Automation (Overall): **1200**</li>
                                    <li>Overall Automation Progress: **49.2% (Red bar)**</li>
                                    <li>Overall Automation Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**CRM Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **100** (Calculated sum matches CSV)</li>
                                    <li>Planned to Automate: **180**</li>
                                    <li>Automation Progress: **55.6% (Red bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Imaging Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **260** (Calculated sum matches CSV)</li>
                                    <li>Planned to Automate: **280**</li>
                                    <li>Automation Progress: **92.9% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Phoenix Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **130** (Calculated sum matches CSV)</li>
                                    <li>Planned to Automate: **220**</li>
                                    <li>Automation Progress: **59.1% (Red bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Ace Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **100** (Calculated sum matches CSV)</li>
                                    <li>Planned to Automate: **200**</li>
                                    <li>Automation Progress: **50.0% (Red bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div class="mb-8">
                        <h5 class="text-lg font-semibold text-gray-900 mb-2">Scenario 3: Data Inconsistencies (Triggering Warnings)</h5>
                        <p class="text-gray-700 mb-2">This scenario is designed to trigger both the overall "Automated &gt; Planned" warning and a team-specific "Roll-up Mismatch" warning.</p>
                        <h6 class="text-md font-medium text-gray-800 mb-1">CSV Data:</h6>
                        <pre id="scenario3CsvData" class="bg-gray-100 p-2 rounded text-sm overflow-auto mb-2"><code>Metric,Value
PlannedToAutomate,250
CRM_Total,100
CRM_PlannedToAutomate,80
CRM_Automated,70
CRM_Unit_Total,20
CRM_Unit_PlannedToAutomate,15
CRM_Unit_Automated,15
CRM_Functional_Total,30
CRM_Functional_PlannedToAutomate,25
CRM_Functional_Automated,25
CRM_IncrementalDataLoad_Total,10
CRM_IncrementalDataLoad_PlannedToAutomate,8
CRM_IncrementalDataLoad_Automated,10
CRM_FullLoadDataValidation_Total,15
CRM_FullLoadDataValidation_PlannedToAutomate,12
CRM_FullLoadDataValidation_Automated,15
CRM_UserAcceptance_Total,10
CRM_UserAcceptance_PlannedToAutomate,8
CRM_UserAcceptance_Automated,10
CRM_API_Total,5
CRM_API_PlannedToAutomate,4
CRM_API_Automated,5
CRM_Regression_Total,5
CRM_Regression_PlannedToAutomate,4
CRM_Regression_Automated,4
CRM_Smoke_Total,5
CRM_Smoke_PlannedToAutomate,4
CRM_Smoke_Automated,20
Imaging_Total,100
Imaging_PlannedToAutomate,90
Imaging_Automated,95
Imaging_Unit_Total,20
Imaging_Unit_PlannedToAutomate,18
Imaging_Unit_Automated,17
Imaging_Functional_Total,30
Imaging_Functional_PlannedToAutomate,27
Imaging_Functional_Automated,25
Imaging_IncrementalDataLoad_Total,10
Imaging_IncrementalDataLoad_PlannedToAutomate,9
Imaging_IncrementalDataLoad_Automated,8
Imaging_FullLoadDataValidation_Total,15
Imaging_FullLoadDataValidation_PlannedToAutomate,13
Imaging_FullLoadDataValidation_Automated,12
Imaging_UserAcceptance_Total,10
Imaging_UserAcceptance_PlannedToAutomate,9
Imaging_UserAcceptance_Automated,8
Imaging_API_Total,5
Imaging_API_PlannedToAutomate,4
Imaging_API_Automated,3
Imaging_Regression_Total,5
Imaging_Regression_PlannedToAutomate,4
Imaging_Regression_Automated,3
Imaging_Smoke_Total,5
Imaging_Smoke_PlannedToAutomate,4
Imaging_Smoke_Automated,2
Phoenix_Total,100
Phoenix_PlannedToAutomate,80
Phoenix_Automated,70
Phoenix_Unit_Total,20
Phoenix_Unit_PlannedToAutomate,16
Phoenix_Unit_Automated,18
Phoenix_Functional_Total,30
Phoenix_Functional_PlannedToAutomate,24
Phoenix_Functional_Automated,30
Phoenix_IncrementalDataLoad_Total,10
Phoenix_IncrementalDataLoad_PlannedToAutomate,8
Phoenix_IncrementalDataLoad_Automated,12
Phoenix_FullLoadDataValidation_Total,35
Phoenix_FullLoadDataValidation_PlannedToAutomate,12
Phoenix_FullLoadDataValidation_Automated,18
Phoenix_UserAcceptance_Total,10
Phoenix_UserAcceptance_PlannedToAutomate,8
Phoenix_UserAcceptance_Automated,12
Phoenix_API_Total,5
Phoenix_API_PlannedToAutomate,4
Phoenix_API_Automated,7
Phoenix_Regression_Total,5
Phoenix_Regression_PlannedToAutomate,4
Phoenix_Regression_Automated,7
Phoenix_Smoke_Total,5
Phoenix_Smoke_PlannedToAutomate,4
Phoenix_Smoke_Automated,15
Ace_Total,100
Ace_PlannedToAutomate,80
Ace_Automated,70
Ace_Unit_Total,20
Ace_Unit_PlannedToAutomate,16
Ace_Unit_Automated,18
Ace_Functional_Total,30
Ace_Functional_PlannedToAutomate,24
Ace_Functional_Automated,30
Ace_IncrementalDataLoad_Total,10
Ace_IncrementalDataLoad_PlannedToAutomate,8
Ace_IncrementalDataLoad_Automated,12
Ace_FullLoadDataValidation_Total,35
Ace_FullLoadDataValidation_PlannedToAutomate,12
Ace_FullLoadDataValidation_Automated,18
Ace_UserAcceptance_Total,10
Ace_UserAcceptance_PlannedToAutomate,8
Ace_UserAcceptance_Automated,12
Ace_API_Total,5
Ace_API_PlannedToAutomate,4
Ace_API_Automated,7
Ace_Regression_Total,5
Ace_Regression_PlannedToAutomate,4
Ace_Regression_Automated,7
Ace_Smoke_Total,5
Ace_Smoke_PlannedToAutomate,4
Ace_Smoke_Automated,15
</code></pre>
                        <div class="flex items-center space-x-4 mt-2">
                            <a href="#" class="copy-scenario-data inline-block text-blue-600 hover:text-blue-800 text-sm font-semibold transition duration-200" data-scenario-id="scenario3CsvData">
                                Copy CSV Data
                            </a>
                            <button class="load-scenario-data px-4 py-1 bg-green-600 text-white font-semibold rounded-lg shadow-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition duration-200 text-sm" data-scenario-id="scenario3CsvData">
                                Load CSV Data
                            </button>
                            <span id="scenario3ConfirmMessage" class="text-xs text-green-600 hidden">Copied/Loaded!</span>
                        </div>
                        <h6 class="text-md font-medium text-gray-800 mb-1 mt-4">Expected Outcomes:</h6>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 ml-4">
                            <li>**Overall Automation Coverage:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests Currently Automated: **420**</li>
                                    <li>Tests Planned for Automation (Overall): **250**</li>
                                    <li>Overall Automation Progress: **168.0% (Green bar, but will show warning)**</li>
                                    <li>Overall Automation Warning: **Visible**</li>
                                </ul>
                            </li>
                            <li>**CRM Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **104** (Calculated sum of 15+25+10+15+10+5+4+20 = 104)</li>
                                    <li>Planned to Automate: **80**</li>
                                    <li>Automation Progress: **130.0% (Green bar)**</li>
                                    <li>Roll-up Warning: **Visible** (Calculated 104 ≠ CSV 70)</li>
                                </ul>
                            </li>
                            <li>**Imaging Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **78** (Calculated sum of 17+25+8+12+8+3+3+2 = 78)</li>
                                    <li>Planned to Automate: **90**</li>
                                    <li>Automation Progress: **86.7% (Green bar)**</li>
                                    <li>Roll-up Warning: **Visible** (Calculated 78 ≠ CSV 95)</li>
                                </ul>
                            </li>
                            <li>**Phoenix Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **119** (Calculated sum of 18+30+12+18+12+7+7+15 = 119)</li>
                                    <li>Planned to Automate: **80**</li>
                                    <li>Automation Progress: **148.8% (Green bar)**</li>
                                    <li>Roll-up Warning: **Visible** (Calculated 119 ≠ CSV 70)</li>
                                </ul>
                            </li>
                            <li>**Ace Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Tests Automated: **119** (Calculated sum of 18+30+12+18+12+7+7+15 = 119)</li>
                                    <li>Planned to Automate: **80**</li>
                                    <li>Automation Progress: **148.8% (Green bar)**</li>
                                    <li>Roll-up Warning: **Visible** (Calculated 119 ≠ CSV 70)</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <p class="text-gray-700 mt-6">
                        After making changes to these constants, save the HTML file and refresh your browser to see the effects.
                    </p>
                </div>
            </section>

        </main>

        <!-- Footer -->
        <footer class="bg-gray-800 text-white p-4 text-center text-sm mt-8 rounded-t-lg">
            <p>&copy; 2025 Enterprise Applications - Automation Dashboard. Data as of <span id="currentDate"></span>.</p>
        </footer>
    </div>

    <script>
        // --- Configuration for Data Loading ---
        // Set this to 'true' to load data from the HARDCODED_CSV_DATA string when the page first loads.
        // Set to 'false' to load random data initially (and then rely on the UI 'Load Data' button).
        const LOAD_FROM_HARDCODED_ON_STARTUP = true;

        // This is your hardcoded CSV data. You can paste content from your sample-data.csv here.
        // NOTE: Due to browser security, you cannot directly load from a local file path like C:\temp\rawdata.csv.
        // This string serves as the "hardcoded" data source.
        const HARDCODED_CSV_DATA = `Metric,Value
PlannedToAutomate,110
CRM_Total,120
CRM_PlannedToAutomate,50
CRM_Automated,0
CRM_Unit_Total,0
CRM_Unit_PlannedToAutomate,0
CRM_Unit_Automated,0
CRM_Functional_Total,0
CRM_Functional_PlannedToAutomate,0
CRM_Functional_Automated,0
CRM_IncrementalDataLoad_Total,0
CRM_IncrementalDataLoad_PlannedToAutomate,0
CRM_IncrementalDataLoad_Automated,0
CRM_FullLoadDataValidation_Total,0
CRM_FullLoadDataValidation_PlannedToAutomate,0
CRM_FullLoadDataValidation_Automated,0
CRM_UserAcceptance_Total,0
CRM_UserAcceptance_PlannedToAutomate,0
CRM_UserAcceptance_Automated,0
CRM_API_Total,0
CRM_API_PlannedToAutomate,0
CRM_API_Automated,0
CRM_Regression_Total,120
CRM_Regression_PlannedToAutomate,50
CRM_Regression_Automated,0
CRM_Smoke_Total,0
CRM_Smoke_PlannedToAutomate,0
CRM_Smoke_Automated,0
Imaging_Total,100
Imaging_PlannedToAutomate,50
Imaging_Automated,0
Imaging_Unit_Total,0
Imaging_Unit_PlannedToAutomate,0
Imaging_Unit_Automated,0
Imaging_Functional_Total,0
Imaging_Functional_PlannedToAutomate,0
Imaging_Functional_Automated,0
Imaging_IncrementalDataLoad_Total,0
Imaging_IncrementalDataLoad_PlannedToAutomate,0
Imaging_IncrementalDataLoad_Automated,0
Imaging_FullLoadDataValidation_Total,0
Imaging_FullLoadDataValidation_PlannedToAutomate,0
Imaging_FullLoadDataValidation_Automated,0
Imaging_UserAcceptance_Total,0
Imaging_UserAcceptance_PlannedToAutomate,0
Imaging_UserAcceptance_Automated,0
Imaging_API_Total,0
Imaging_API_PlannedToAutomate,0
Imaging_API_Automated,0
Imaging_Regression_Total,100
Imaging_Regression_PlannedToAutomate,50
Imaging_Regression_Automated,0
Imaging_Smoke_Total,12
Imaging_Smoke_PlannedToAutomate,0
Imaging_Smoke_Automated,0
Phoenix_Total,69
Phoenix_PlannedToAutomate,10
Phoenix_Automated,0
Phoenix_Unit_Total,0
Phoenix_Unit_PlannedToAutomate,0
Phoenix_Unit_Automated,0
Phoenix_Functional_Total,0
Phoenix_Functional_PlannedToAutomate,0
Phoenix_Functional_Automated,0
Phoenix_IncrementalDataLoad_Total,0
Phoenix_IncrementalDataLoad_PlannedToAutomate,0
Phoenix_IncrementalDataLoad_Automated,0
Phoenix_FullLoadDataValidation_Total,0
Phoenix_FullLoadDataValidation_PlannedToAutomate,0
Phoenix_FullLoadDataValidation_Automated,0
Phoenix_UserAcceptance_Total,0
Phoenix_UserAcceptance_PlannedToAutomate,0
Phoenix_UserAcceptance_Automated,0
Phoenix_API_Total,0
Phoenix_API_PlannedToAutomate,0
Phoenix_API_Automated,0
Phoenix_Regression_Total,50
Phoenix_Regression_PlannedToAutomate,10
Phoenix_Regression_Automated,0
Phoenix_Smoke_Total,19
Phoenix_Smoke_PlannedToAutomate,0
Phoenix_Smoke_Automated,0
Ace_Total,0
Ace_PlannedToAutomate,0
Ace_Automated,0
Ace_Unit_Total,0
Ace_Unit_PlannedToAutomate,0
Ace_Unit_Automated,0
Ace_Functional_Total,0
Ace_Functional_PlannedToAutomate,0
Ace_Functional_Automated,0
Ace_IncrementalDataLoad_Total,0
Ace_IncrementalDataLoad_PlannedToAutomate,0
Ace_IncrementalDataLoad_Automated,0
Ace_FullLoadDataValidation_Total,0
Ace_FullLoadDataValidation_PlannedToAutomate,0
Ace_FullLoadDataValidation_Automated,0
Ace_UserAcceptance_Total,0
Ace_UserAcceptance_PlannedToAutomate,0
Ace_UserAcceptance_Automated,0
Ace_API_Total,0
Ace_API_PlannedToAutomate,0
Ace_API_Automated,0
Ace_Regression_Total,0
Ace_Regression_PlannedToAutomate,0
Ace_Regression_Automated,0
Ace_Smoke_Total,0
Ace_Smoke_PlannedToAutomate,0
Ace_Smoke_Automated,0
`;

        const CSV_EXAMPLE_DATA = `Metric,Value
PlannedToAutomate,250
CRM_Total,100
CRM_PlannedToAutomate,80
CRM_Automated,70
CRM_Unit_Total,20
CRM_Unit_PlannedToAutomate,15
CRM_Unit_Automated,15
CRM_Functional_Total,30
CRM_Functional_PlannedToAutomate,25
CRM_Functional_Automated,25
CRM_IncrementalDataLoad_Total,10
CRM_IncrementalDataLoad_PlannedToAutomate,8
CRM_IncrementalDataLoad_Automated,10
CRM_FullLoadDataValidation_Total,15
CRM_FullLoadDataValidation_PlannedToAutomate,12
CRM_FullLoadDataValidation_Automated,15
CRM_UserAcceptance_Total,10
CRM_UserAcceptance_PlannedToAutomate,8
CRM_UserAcceptance_Automated,10
CRM_API_Total,5
CRM_API_PlannedToAutomate,4
CRM_API_Automated,5
CRM_Regression_Total,5
CRM_Regression_PlannedToAutomate,4
CRM_Regression_Automated,4
CRM_Smoke_Total,5
CRM_Smoke_PlannedToAutomate,4
CRM_Smoke_Automated,20
Imaging_Total,100
Imaging_PlannedToAutomate,90
Imaging_Automated,95
Imaging_Unit_Total,20
Imaging_Unit_PlannedToAutomate,18
Imaging_Unit_Automated,17
Imaging_Functional_Total,30
Imaging_Functional_PlannedToAutomate,27
Imaging_Functional_Automated,25
Imaging_IncrementalDataLoad_Total,10
Imaging_IncrementalDataLoad_PlannedToAutomate,9
Imaging_IncrementalDataLoad_Automated,8
Imaging_FullLoadDataValidation_Total,15
Imaging_FullLoadDataValidation_PlannedToAutomate,13
Imaging_FullLoadDataValidation_Automated,12
Imaging_UserAcceptance_Total,10
Imaging_UserAcceptance_PlannedToAutomate,9
Imaging_UserAcceptance_Automated,8
Imaging_API_Total,5
Imaging_API_PlannedToAutomate,4
Imaging_API_Automated,3
Imaging_Regression_Total,5
Imaging_Regression_PlannedToAutomate,4
Imaging_Regression_Automated,3
Imaging_Smoke_Total,5
Imaging_Smoke_PlannedToAutomate,4
Imaging_Smoke_Automated,2
Phoenix_Total,100
Phoenix_PlannedToAutomate,80
Phoenix_Automated,70
Phoenix_Unit_Total,20
Phoenix_Unit_PlannedToAutomate,16
Phoenix_Unit_Automated,18
Phoenix_Functional_Total,30
Phoenix_Functional_PlannedToAutomate,24
Phoenix_Functional_Automated,30
Phoenix_IncrementalDataLoad_Total,10
Phoenix_IncrementalDataLoad_PlannedToAutomate,8
Phoenix_IncrementalDataLoad_Automated,12
Phoenix_FullLoadDataValidation_Total,35
Phoenix_FullLoadDataValidation_PlannedToAutomate,12
Phoenix_FullLoadDataValidation_Automated,18
Phoenix_UserAcceptance_Total,10
Phoenix_UserAcceptance_PlannedToAutomate,8
Phoenix_UserAcceptance_Automated,12
Phoenix_API_Total,5
Phoenix_API_PlannedToAutomate,4
Phoenix_API_Automated,7
Phoenix_Regression_Total,5
Phoenix_Regression_PlannedToAutomate,4
Phoenix_Regression_Automated,7
Phoenix_Smoke_Total,5
Phoenix_Smoke_PlannedToAutomate,4
Phoenix_Smoke_Automated,15
Ace_Total,100
Ace_PlannedToAutomate,80
Ace_Automated,70
Ace_Unit_Total,20
Ace_Unit_PlannedToAutomate,16
Ace_Unit_Automated,18
Ace_Functional_Total,30
Ace_Functional_PlannedToAutomate,24
Ace_Functional_Automated,30
Ace_IncrementalDataLoad_Total,10
Ace_IncrementalDataLoad_PlannedToAutomate,8
Ace_IncrementalDataLoad_Automated,12
Ace_FullLoadDataValidation_Total,35
Ace_FullLoadDataValidation_PlannedToAutomate,12
Ace_FullLoadDataValidation_Automated,18
Ace_UserAcceptance_Total,10
Ace_UserAcceptance_PlannedToAutomate,8
Ace_UserAcceptance_Automated,12
Ace_API_Total,5
Ace_API_PlannedToAutomate,4
Ace_API_Automated,7
Ace_Regression_Total,5
Ace_Regression_PlannedToAutomate,4
Ace_Regression_Automated,7
Ace_Smoke_Total,5
Ace_Smoke_PlannedToAutomate,4
Ace_Smoke_Automated,15
`;


        document.addEventListener('DOMContentLoaded', initializeDashboard);

        function initializeDashboard() {
            // Set current date in footer
            const today = new Date();
            document.getElementById('currentDate').textContent = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            // Load initial data based on configuration flag
            if (LOAD_FROM_HARDCODED_ON_STARTUP) {
                applyData(parseCSV(HARDCODED_CSV_DATA));
            } else {
                loadDefaultRandomData();
            }

            // Set the CSV example data
            document.getElementById('csvExampleData').textContent = CSV_EXAMPLE_DATA;


            // Event listener for the Load Data button (always active to allow manual updates)
            document.getElementById('loadDataBtn').addEventListener('click', () => {
                const csvInput = document.getElementById('csvInput').value;
                const parsed = parseCSV(csvInput);
                if (Object.keys(parsed).length > 0) {
                    applyData(parsed);
                    const dataLoadMessage = document.getElementById('dataLoadMessage');
                    dataLoadMessage.textContent = 'Data loaded successfully!';
                    dataLoadMessage.classList.remove('hidden', 'text-red-600');
                    dataLoadMessage.classList.add('text-green-600');
                    setTimeout(() => dataLoadMessage.classList.add('hidden'), 3000);
                } else {
                    const dataLoadMessage = document.getElementById('dataLoadMessage');
                    dataLoadMessage.textContent = 'No valid data found in CSV. Please check format.';
                    dataLoadMessage.classList.remove('hidden', 'text-green-600');
                    dataLoadMessage.classList.add('text-red-600');
                }
            });

            // Event listener for the Copy CSV Example link
            document.getElementById('copyCsvExampleLink').addEventListener('click', (event) => {
                event.preventDefault(); // Prevent default anchor link behavior (e.g., navigating to #)
                const csvExampleData = document.getElementById('csvExampleData').textContent;
                const copyConfirmMessage = document.getElementById('copyConfirmMessage');

                // Use a temporary textarea to copy text to clipboard
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = csvExampleData.trim(); // Trim to remove any leading/trailing whitespace from the pre tag
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                document.execCommand('copy'); // Deprecated but widely supported for iframes
                document.body.removeChild(tempTextArea);

                copyConfirmMessage.classList.remove('hidden');
                setTimeout(() => {
                    copyConfirmMessage.classList.add('hidden');
                }, 2000); // Hide "Copied!" message after 2 seconds
            });

            // Add event listeners for scenario specific copy/load buttons
            document.querySelectorAll('.copy-scenario-data').forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    const scenarioId = event.target.dataset.scenarioId;
                    const csvDataElement = document.getElementById(scenarioId);
                    const csvData = csvDataElement.textContent;
                    const confirmMessageElement = document.getElementById(`${scenarioId.replace('CsvData', 'ConfirmMessage')}`);

                    const tempTextArea = document.createElement('textarea');
                    tempTextArea.value = csvData.trim();
                    document.body.appendChild(tempTextArea);
                    tempTextArea.select();
                    document.execCommand('copy');
                    document.body.removeChild(tempTextArea);

                    confirmMessageElement.textContent = 'Copied!';
                    confirmMessageElement.classList.remove('hidden', 'text-red-600');
                    confirmMessageElement.classList.add('text-green-600');
                    setTimeout(() => confirmMessageElement.classList.add('hidden'), 2000);
                });
            });

            document.querySelectorAll('.load-scenario-data').forEach(button => {
                button.addEventListener('click', (event) => {
                    const scenarioId = event.target.dataset.scenarioId;
                    const csvDataElement = document.getElementById(scenarioId);
                    const csvData = csvDataElement.textContent;
                    const confirmMessageElement = document.getElementById(`${scenarioId.replace('CsvData', 'ConfirmMessage')}`);

                    const parsed = parseCSV(csvData);
                    if (Object.keys(parsed).length > 0) {
                        applyData(parsed);
                        confirmMessageElement.textContent = 'Loaded!';
                        confirmMessageElement.classList.remove('hidden', 'text-red-600');
                        confirmMessageElement.classList.add('text-green-600');
                        setTimeout(() => confirmMessageElement.classList.add('hidden'), 2000);
                    } else {
                        confirmMessageElement.textContent = 'Error loading data!';
                        confirmMessageElement.classList.remove('hidden', 'text-green-600');
                        confirmMessageElement.classList.add('text-red-600');
                    }
                });
            });

            // Event listeners for Export buttons (now commented out in HTML, but kept here for reference if re-enabled)
            // document.getElementById('exportCsvBtn').addEventListener('click', exportDataAsCsv);
            // document.getElementById('exportJsonBtn').addEventListener('click', exportDataAsJson);

            // Add event listeners for the new toggle breakdown links
            document.querySelectorAll('.toggle-breakdown-link').forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    const targetId = event.target.dataset.target;
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.classList.toggle('hidden');
                        if (targetElement.classList.contains('hidden')) {
                            event.target.textContent = 'Click to see Breakdown by Test Type';
                        } else {
                            event.target.textContent = 'Hide Breakdown by Test Type';
                        }
                    }
                });
            });
        }

        // Helper function to generate random data for demonstration
        function loadDefaultRandomData() {
            // This function is now less critical as HARDCODED_CSV_DATA is primary default.
            // It could be removed if random data generation is no longer desired.
            // For now, keeping it as a fallback if LOAD_FROM_HARDCODED_ON_STARTUP is false.
            function generateRandomMetric(baseTotal) {
                const total = Math.floor(baseTotal * (0.8 + Math.random() * 0.4)); // +/- 20%
                const plannedToAutomate = Math.floor(total * (0.5 + Math.random() * 0.5));
                const automated = Math.floor(plannedToAutomate * (0.3 + Math.random() * 0.6)); // Wide range for colors
                return { total, plannedToAutomate, automated };
            }

            const data = {};
            const teamNames = ['CRM', 'Imaging', 'Phoenix', 'Ace']; // Order updated
            const testTypeNames = ['Unit', 'Functional', 'IncrementalDataLoad', 'FullLoadDataValidation', 'UserAcceptance', 'API', 'Regression', 'Smoke'];

            let overallPlannedSum = 0;
            let overallAutomatedSum = 0;

            teamNames.forEach(team => {
                let teamTotal = 0;
                let teamPlannedToAutomate = 0;
                let teamAutomated = 0; // This will be the sum of its test types

                testTypeNames.forEach(testType => {
                    const metrics = generateRandomMetric(100); // Base for individual test types
                    data[`${team}_${testType}_Total`] = metrics.total;
                    data[`${team}_${testType}_PlannedToAutomate`] = metrics.plannedToAutomate;
                    data[`${team}_${testType}_Automated`] = metrics.automated;

                    teamTotal += metrics.total;
                    teamPlannedToAutomate += metrics.plannedToAutomate;
                    teamAutomated += metrics.automated; // Summing up for the team's automated total
                });

                data[`${team}_Total`] = teamTotal;
                data[`${team}_PlannedToAutomate`] = teamPlannedToAutomate;
                data[`${team}_Automated`] = teamAutomated; // Store the calculated sum as the team's automated total

                overallPlannedSum += teamPlannedToAutomate;
                overallAutomatedSum += teamAutomated;
            });

            data['PlannedToAutomate'] = overallPlannedSum; // Overall planned is sum of team planned
            // The overall current automated will be calculated by applyData from team_Automated sums

            applyData(data);
        }


        // Helper function to parse CSV string into a data object
        function parseCSV(csvString) {
            const parsedData = {};
            const lines = csvString.trim().split('\n');

            if (lines.length < 2) {
                console.warn('CSV string is empty or has no data rows.');
                return parsedData;
            }

            const headers = lines[0].split(',').map(h => h.trim());
            if (headers[0] !== 'Metric' || headers[1] !== 'Value') {
                console.error('CSV headers must be "Metric" and "Value".');
                return parsedData;
            }

            for (let i = 1; i < lines.length; i++) {
                const parts = lines[i].split(',');
                if (parts.length === 2) {
                    const metric = parts[0].trim();
                    const value = parseInt(parts[1].trim(), 10);
                    if (!isNaN(value)) {
                        parsedData[metric] = value;
                    } else {
                        console.warn(`Skipping invalid value for metric "${metric}": ${parts[1].trim()}`);
                    }
                }
            }
            return parsedData;
        }

        let currentDashboardData = {}; // Store the last loaded data globally

        function applyData(data) {
            currentDashboardData = data; // Update global data

            // Overall Automation Coverage Metrics
            const plannedToAutomateOverall = data.PlannedToAutomate || 0;
            let totalCurrentlyAutomated = 0; // This will be the sum of team-level automated counts

            // Define team prefixes in the desired order
            const teamPrefixes = ['CRM', 'Imaging', 'Phoenix', 'Ace']; // Order updated
            // Define test type names for iteration and display
            const testTypeDisplayNames = {
                'Unit': 'Unit Tests',
                'Functional': 'Functional Tests',
                'IncrementalDataLoad': 'Incremental Data Load Tests',
                'FullLoadDataValidation': 'Full Load Data Validation Tests',
                'UserAcceptance': 'User Acceptance Tests',
                'API': 'API Tests',
                'Regression': 'Regression Tests',
                'Smoke': 'Smoke Tests'
            };
            const testTypeMetricPrefixes = Object.keys(testTypeDisplayNames); // e.g., ['Unit', 'Functional', ...]

            // Process Team Data
            teamPrefixes.forEach(teamPrefix => {
                const lowerCaseTeamPrefix = teamPrefix.toLowerCase(); // e.g., 'crm'

                const teamTotal = data[`${teamPrefix}_Total`] || 0;
                const teamPlannedToAutomate = data[`${teamPrefix}_PlannedToAutomate`] || 0;
                // Get the 'team_Automated' value directly from CSV for comparison/warning
                const csvTeamAutomated = data[`${teamPrefix}_Automated`] || 0;

                let calculatedTeamAutomated = 0; // This will be the sum of automated tests from its constituent test types

                const cardElement = document.getElementById(`${lowerCaseTeamPrefix}Card`);
                // Note: The ID for the content div changed to `teamTestTypeBreakdownContent`
                const testTypeBreakdownDiv = document.getElementById(`${lowerCaseTeamPrefix}TestTypeBreakdown`);
                const rollupWarningDiv = document.getElementById(`${lowerCaseTeamPrefix}RollupWarning`);
                const teamAutomationProgressBar = document.getElementById(`${lowerCaseTeamPrefix}AutomationProgressBar`);
                const teamAutomationProgressText = document.getElementById(`${lowerCaseTeamPrefix}AutomationProgressText`);


                // Clear previous breakdown content
                if (testTypeBreakdownDiv) {
                    testTypeBreakdownDiv.innerHTML = '';
                }

                if (cardElement) {
                    document.getElementById(`${lowerCaseTeamPrefix}Total`).textContent = teamTotal.toLocaleString();
                    document.getElementById(`${lowerCaseTeamPrefix}PlannedToAutomate`).textContent = teamPlannedToAutomate.toLocaleString();
                    // document.getElementById(`${lowerCaseTeamPrefix}Automated`).textContent = teamAutomated.toLocaleString(); // This line will be updated later

                    // Populate Test Type Breakdown for the current team and calculate calculatedTeamAutomated
                    testTypeMetricPrefixes.forEach(testTypePrefix => {
                        const testTypeTotal = data[`${teamPrefix}_${testTypePrefix}_Total`] || 0; // Get the new Total value
                        const testTypePlannedToAutomate = data[`${teamPrefix}_${testTypePrefix}_PlannedToAutomate`] || 0;
                        const testTypeAutomated = data[`${teamPrefix}_${testTypePrefix}_Automated`] || 0;

                        calculatedTeamAutomated += testTypeAutomated; // Summing up automated tests for the team

                        const testTypeCoverage = testTypePlannedToAutomate > 0 ? ((testTypeAutomated / testTypePlannedToAutomate) * 100).toFixed(1) : 0;

                        let testTypeProgressBarColorClass;
                        if (testTypeCoverage > 80) {
                            testTypeProgressBarColorClass = 'bg-green-600';
                        } else if (testTypeCoverage > 50) {
                            testTypeProgressBarColorClass = 'bg-yellow-600';
                        } else {
                            testTypeProgressBarColorClass = 'bg-red-600';
                        }

                        if (testTypeBreakdownDiv) {
                            const div = document.createElement('div');
                            div.className = 'mb-1'; // Add some margin between test types
                            div.innerHTML = `
                                <span class="font-medium">${testTypeDisplayNames[testTypePrefix]}:</span> Total: <span class="font-semibold">${testTypeTotal.toLocaleString()}</span> / Automated: <span class="font-semibold">${testTypeAutomated.toLocaleString()}</span> / Planned: <span class="font-semibold">${testTypePlannedToAutomate.toLocaleString()}</span>
                                <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                    <div class="h-2 rounded-full ${testTypeProgressBarColorClass}" style="width: ${Math.min(100, testTypeCoverage)}%;"></div>
                                </div>
                                <p class="text-right text-xs text-gray-600 mt-0.5">${testTypeCoverage}% Automated</p>
                            `;
                            testTypeBreakdownDiv.appendChild(div);
                        }
                    });

                    // Now update the team's main "Tests Automated" display with the calculated sum
                    document.getElementById(`${lowerCaseTeamPrefix}Automated`).textContent = calculatedTeamAutomated.toLocaleString();

                    const teamAutomationCoverage = teamPlannedToAutomate > 0 ? ((calculatedTeamAutomated / teamPlannedToAutomate) * 100).toFixed(1) : 0;
                    
                    // Update team-level progress bar
                    if (teamAutomationProgressBar && teamAutomationProgressText) {
                        teamAutomationProgressBar.style.width = `${Math.min(100, teamAutomationCoverage)}%`;
                        teamAutomationProgressBar.className = `h-3 rounded-full ${teamAutomationCoverage <= 60 ? 'bg-red-600' : (teamAutomationCoverage > 60 && teamAutomationCoverage <= 80 ? 'bg-yellow-600' : 'bg-green-600')}`;
                        teamAutomationProgressText.textContent = `${teamAutomationCoverage}% Automated`;
                    }


                    // Apply color coding for the team card based on calculated coverage
                    cardElement.classList.remove(
                        'bg-green-50', 'border-green-200',
                        'bg-yellow-50', 'border-yellow-200',
                        'bg-red-50', 'border-red-200'
                    );

                    let teamBgColorClass, teamBorderColorClass;
                    if (teamAutomationCoverage > 80) {
                        teamBgColorClass = 'bg-green-50';
                        teamBorderColorClass = 'border-green-200';
                    } else if (teamAutomationCoverage > 50) {
                        teamBgColorClass = 'bg-yellow-50';
                        teamBorderColorClass = 'border-yellow-200';
                    } else {
                        teamBgColorClass = 'bg-red-50';
                        teamBorderColorClass = 'border-red-200';
                    }
                    cardElement.classList.add(teamBgColorClass, teamBorderColorClass);

                    // Check for roll-up consistency and display warning
                    // Only show warning if csvTeamAutomated was explicitly provided (not 0) and it doesn't match the calculated sum
                    if (csvTeamAutomated !== 0 && calculatedTeamAutomated !== csvTeamAutomated) {
                        if (rollupWarningDiv) {
                             rollupWarningDiv.classList.remove('hidden');
                        }
                    } else {
                        if (rollupWarningDiv) {
                            rollupWarningDiv.classList.add('hidden');
                        }
                    }
                }
                totalCurrentlyAutomated += calculatedTeamAutomated; // Sum up calculated team-level automated counts for overall total
            });


            document.getElementById('currentAutomatedCount').textContent = totalCurrentlyAutomated.toLocaleString();
            document.getElementById('plannedAutomationCount').textContent = plannedToAutomateOverall.toLocaleString();

            const overallAutomationProgress = plannedToAutomateOverall > 0 ? (totalCurrentlyAutomated / plannedToAutomateOverall) * 100 : 0;
            const overallAutomationProgressBar = document.getElementById('overallAutomationProgressBar');
            const overallAutomationProgressText = document.getElementById('overallAutomationProgressText');
            const overallAutomationWarning = document.getElementById('overallAutomationWarning');


            overallAutomationProgressBar.style.width = `${Math.min(100, overallAutomationProgress)}%`;
            overallAutomationProgressBar.className = `h-4 rounded-full ${overallAutomationProgress <= 60 ? 'bg-red-600' : (overallAutomationProgress > 60 && overallAutomationProgress <= 80 ? 'bg-yellow-600' : 'bg-green-600')}`;
            overallAutomationProgressText.textContent = `${overallAutomationProgress.toFixed(1)}% Automated`;

            // Display warning if automated tests exceed planned tests overall
            if (totalCurrentlyAutomated > plannedToAutomateOverall) {
                overallAutomationWarning.classList.remove('hidden');
            } else {
                overallAutomationWarning.classList.add('hidden');
            }
        }

        // Function to export data as CSV
        function exportDataAsCsv() {
            let csvContent = "Metric,Value\n";
            for (const key in currentDashboardData) {
                if (currentDashboardData.hasOwnProperty(key)) {
                    csvContent += `${key},${currentDashboardData[key]}\n`;
                }
            }
            downloadFile(csvContent, 'qa_dashboard_data.csv', 'text/csv');
        }

        // Function to export data as JSON
        function exportDataAsJson() {
            const jsonContent = JSON.stringify(currentDashboardData, null, 2); // Pretty print JSON
            downloadFile(jsonContent, 'qa_dashboard_data.json', 'application/json');
        }

        // Generic function to trigger file download
        function downloadFile(content, filename, contentType) {
            const blob = new Blob([content], { type: contentType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a); // Required for Firefox
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url); // Clean up the URL object
        }
    </script>
</body>
</html>
