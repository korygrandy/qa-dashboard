<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Enterprise Applications - Automation Metrics Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for a professional look */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
            scroll-behavior: smooth; /* Smooth scrolling for anchor links */
        }
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #e0e0e0;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        /* Hide sections and header links when printing */
        @media print {
            #howToUseSection,
            #understandingWarningSection,
            #update-data-section,
            #developerReadmeSection,
            .header-links,
            footer { /* Added footer to hide it during print */
                display: none !important;
            }
            body {
                background-color: #fff; /* White background for printing */
            }
            /* Adjust margins for print */
            .container.mx-auto {
                margin-left: 0;
                margin-right: 0;
                padding-left: 0;
                padding-right: 0;
            }
            /* Ensure content fits on page */
            section {
                box-shadow: none !important;
                border: none !important;
            }
            /* Force background colors to print for the progress bar */
            #overallAutomationProgressBar {
                -webkit-print-color-adjust: exact; /* For WebKit browsers like Chrome, Safari */
                color-adjust: exact; /* Standard property */
                print-color-adjust: exact; /* For Firefox */
            }
        }
        /* Spinner animation */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #3b82f6;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body id="top" class="bg-gray-100 text-gray-800">
    <!-- Overlay for Passed/Failed messages -->
    <div id="dashboardMessageOverlay" class="fixed top-0 left-0 right-0 z-50 p-4 text-center text-lg font-semibold rounded-b-lg shadow-lg transition-opacity duration-1000 ease-out opacity-0 hidden">
        <!-- Message will be inserted here -->
    </div>

    <div class="min-h-screen flex flex-col">
        <header class="bg-gradient-to-r from-blue-700 to-blue-900 text-white p-6 shadow-lg rounded-b-lg">
            <div class="container mx-auto flex justify-between items-center">
                <h1 class="text-3xl font-bold">Enterprise Applications</h1>
                <h2 class="text-2xl font-semibold">Automation Metrics Dashboard</h2>
            </div>
            <div class="container mx-auto mt-4 text-center flex justify-center items-center space-x-4 header-links">
                <a href="#howToUseSection" class="inline-block bg-white text-blue-700 px-5 py-2 rounded-lg font-semibold shadow-md hover:bg-blue-100 transition duration-200">
                    Update Dashboard Data
                </a>
                <button onclick="window.print()" class="inline-flex items-center bg-white text-blue-700 px-5 py-2 rounded-lg font-semibold shadow-md hover:bg-blue-100 transition duration-200">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m0 0l3 3m-3-3l-3 3m3-3v-3a2 2 0 012-2h4a2 2 0 012 2v3m0 0l3 3m-3-3l-3 3m-3-3v-3a2 2 0 012-2h4a2 2 0 012 2v3"></path>
                    </svg>
                    Print Dashboard
                </button>
                </div>
        </header>

        <main class="flex-grow container mx-auto p-6 space-y-8">

            <section class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">Overall Automation Coverage</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-purple-50 p-6 rounded-lg shadow-sm border border-purple-200">
                        <h4 class="text-xl font-medium text-purple-800 mb-2">Total Tests Currently Automated</h4>
                        <p id="currentAutomatedCount" class="text-5xl font-extrabold text-purple-700">0</p>
                        <p class="text-gray-600 mt-2">Sum of tests automated across all categories.</p>
                    </div>
                    <div class="bg-orange-50 p-6 rounded-lg shadow-sm border border-orange-200">
                        <h4 class="text-xl font-medium text-orange-800 mb-2">Tests Planned for Automation (Overall)</h4>
                        <p id="plannedAutomationCount" class="text-5xl font-extrabold text-orange-700">0</p>
                        <p class="text-gray-600 mt-2">Total tests targeted for automation across all categories.</p>
                    </div>
                </div>
                <div class="mt-6">
                    <h4 class="text-xl font-medium text-gray-800 mb-2">Overall Automation Progress</h4>
                    <div class="w-full bg-gray-200 rounded-full h-4">
                        <div id="overallAutomationProgressBar" class="bg-purple-600 h-4 rounded-full" style="width: 0%;"></div>
                    </div>
                    <p id="overallAutomationProgressText" class="text-right text-sm text-gray-600 mt-1">0% Automated</p>
                    <div id="overallAutomationWarning" class="mt-2 text-red-600 font-semibold text-sm hidden">
                        Warning: Total Automated Tests exceed Tests Planned for Automation. Please verify data.
                    </div>
                </div>
            </section>

            <section class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">Automation Coverage by Testing Team</h3>
                <div id="teamCardsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Team cards will be dynamically inserted here by JavaScript -->
                </div>
            </section>

            <section id="howToUseSection" class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">How to Use This Dashboard</h3>
                <p class="text-gray-700 mb-4">
                    This dashboard provides a high-level overview of our Quality Assurance (QA) testing metrics.
                </p>

                <h4 class="text-xl font-medium text-gray-800 mb-2">1. Overall Automation Coverage:</h4>
                <ul class="list-disc list-inside text-gray-700 space-y-1 mb-4">
                    <li>**Total Tests Currently Automated:** This value is automatically calculated by summing the "Automated" counts of all individual test types across all teams.</li>
                    <li>**Tests Planned for Automation (Overall):** This value is automatically calculated by summing the "Planned to Automate" counts of all individual test types across all teams (excluding Functional Tests).</li>
                    <li>**Overall Automation Progress Bar:** Visual indicator of automation completion.
                        <ul class="list-circle list-inside ml-4">
                            <li><span class="font-semibold text-green-700">Green:</span> > 80% Automated.</li>
                            <li><span class="font-semibold text-yellow-600">Yellow:</span> > 60% &lt;= 80% Automated.</li>
                            <li><span class="font-semibold text-red-600">Red:</span> &lt;= 60% Automated.</li>
                        </ul>
                    </li>
                </ul>

                <h4 class="text-xl font-medium text-gray-800 mb-2">2. Automation Coverage by Testing Team:</h4>
                <ul class="list-disc list-inside text-gray-700 space-y-1 mb-4">
                    <li>For each team (Avengers, Imaging, Phoenix, Ace, Agency), you'll see:
                        <ul class="list-circle list-inside ml-4">
                            <li>**Total Tests in Category:** This value is automatically calculated by summing the "Total" counts of all individual test types within this team.</li>
                            <li>**Planned to Automate:** This value is automatically calculated by summing the "Planned to Automate" counts of all individual test types within this team (excluding Functional Tests).</li>
                            <li>**Tests Automated:** This value is automatically calculated by summing the "Automated" counts of all individual test types within this team.</li>
                            <li>**Automation Progress Bar:** Visual progress for the team.</li>
                            <li>**Breakdown by Test Type:** Detailed progress for Unit, Functional, API tests, etc., within each team, including individual progress bars. For Functional Tests, "Planned" will show as "N/A" and will not be included in the team's "Planned to Automate" sum.</li>
                        </ul>
                    </li>
                    <li>**Team Card Color Coding:**
                        <ul class="list-circle list-inside ml-4">
                            <li><span class="font-semibold text-green-700">Green Background:</span> > 80% automation coverage.</li>
                            <li><span class="font-semibold text-yellow-700">Yellow Background:</span> > 50% but &lt;= 80% automation coverage.</li>
                            <li><span class="font-semibold text-red-700">Red Background:</span> &lt;= 50% automation coverage.</li>
                        </ul>
                    </li>
                </ul>

                <h4 class="text-xl font-medium text-gray-800 mb-2">3. Updating the Data:</h4>
                <p class="text-gray-700 mb-2">
                    You can update the dashboard data by pasting CSV content directly into the text area below.
                    Ensure your CSV has two columns: <code class="font-mono text-sm bg-gray-200 p-1 rounded">Metric</code> and <code class="font-mono text-sm bg-gray-200 p-1 rounded">Value</code>.
                </p>
                <p class="text-gray-700 mb-4">
                    Below is sample data you can copy and paste into the text area to see how the dashboard works with different values and color shadings.
                </p>
                <div class="relative mb-4">
                    <!-- This pre tag displays the sample CSV data. Its content is text, not executable code. -->
                    <pre id="csvExampleData" class="bg-gray-100 p-2 rounded text-sm overflow-auto pr-10"><code></code></pre>
                    <span id="copyConfirmMessage" class="absolute top-2 right-16 text-xs text-green-600 hidden">Copied!</span>
                </div>
                <a href="#" id="copyCsvExampleLink" class="inline-block text-blue-600 hover:text-blue-800 text-sm font-semibold mb-2 transition duration-200">
                    Copy Sample Data
                </a>
                <p class="text-sm text-gray-600 mb-4">
                    To export from Excel: Go to File > Save As > Browse, then select "CSV (Comma delimited) (*.csv)" from the "Save as type" dropdown. Open the .csv file with a simple text editor and copy its content.
                </p>
                <textarea id="csvInput" rows="10" class="w-full p-3 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 font-mono text-sm" placeholder="Paste your CSV data here..."></textarea>
                <div class="mt-4 flex items-center space-x-4">
                    <button id="loadDataBtn" class="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition duration-200">
                        Load Data
                    </button>
                    <a href="#top" class="inline-block px-6 py-2 bg-gray-200 text-gray-800 font-semibold rounded-lg shadow-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 transition duration-200">
                        Back to Top
                    </a>
                </div>
                <p id="dataLoadMessage" class="mt-2 text-sm text-red-600 hidden"></p>
            </section>

            <section id="developerReadmeSection" class="bg-white p-6 rounded-lg shadow-md">
                <h3 id="developerReadmeHeading" class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">
                    Developer Readme
                </h3>
                <div id="developerReadmeContent">
                    <p class="text-gray-700 mb-4">
                        This section provides instructions for developers or advanced users who wish to modify the dashboard's default data loading behavior.
                    </p>

                    <h4 class="text-xl font-medium text-gray-800 mb-2">Data Loading Configuration:</h4>
                    <p class="text-gray-700 mb-2">
                        The dashboard can be configured to load data automatically from a hardcoded string when the page loads, or to rely on random default data until the user manually loads data via the CSV input.
                    </p>
                    <ul class="list-disc list-inside text-gray-700 space-y-2 mb-4">
                        <li>
                            To control this behavior, locate the following JavaScript constant at the top of the `&lt;script&gt;` block:
                            <pre class="bg-gray-100 p-2 rounded text-sm mt-1 mb-1 overflow-auto"><code>const LOAD_FROM_HARDCODED_ON_STARTUP = true;</code></pre>
                            <ul>
                                <li>Set `true`: The dashboard will load data from the `HARDCODED_CSV_DATA` string immediately upon page load.</li>
                                <li>Set to `false`: The dashboard will load random data initially. The "Update Data via CSV" section will then be the primary way to input data.</li>
                            </ul>
                        </li>
                        <li>
                            To modify the hardcoded data, edit the `HARDCODED_CSV_DATA` multiline string constant:
                            <pre class="bg-gray-100 p-2 rounded text-sm mt-1 mb-1 overflow-auto"><code>const HARDCODED_CSV_DATA = `Metric,Value
... your CSV data here ...
`;</code></pre>
                            <p class="text-sm text-gray-600 mt-1">
                                Ensure the CSV format matches the example provided in the "Update Data via CSV" section.
                                Remember, direct file system access (e.g., `C:\temp\rawdata.csv`) is not possible due to browser security policies.
                            </p>
                        </li>
                    </ul>

                    <h4 class="text-xl font-medium text-gray-800 mb-2 mt-6">Regression Test Scenarios:</h4>
                    <p class="text-gray-700 mb-4">
                        Use the following scenarios to validate the dashboard's logic and calculations. Copy the CSV data and paste it into the "Update Data via CSV" text area to test each case.
                    </p>

                    <div class="mb-8">
                        <h5 class="text-lg font-semibold text-gray-900 mb-2">Scenario 1: All Green (High Automation Across the Board)</h5>
                        <p class="text-gray-700 mb-2">This scenario aims for high automation percentages for all teams and test types, resulting in a generally "green" dashboard.</p>
                        <h6 class="text-md font-medium text-gray-800 mb-1">CSV Data:</h6>
                        <!-- This pre tag displays the CSV data for Scenario 1. Its content is text, not executable code. -->
                        <pre id="scenario1CsvData" class="bg-gray-100 p-2 rounded text-sm overflow-auto mb-2"
data-expected-metrics='{
    "overallAutomation": {
        "currentAutomatedCount": 895,
        "plannedAutomationCount": 717,
        "overallAutomationProgress": 124.8,
        "overallAutomationWarningVisible": true
    },
    "teams": {
        "Avengers": {
            "Total": 305,
            "Automated": 170,
            "PlannedToAutomate": 135,
            "AutomationProgress": 125.9,
            "RollupWarningVisible": false
        },
        "Imaging": {
            "Total": 372,
            "Automated": 260,
            "PlannedToAutomate": 205,
            "AutomationProgress": 126.8,
            "RollupWarningVisible": false
        },
        "Phoenix": {
            "Total": 289,
            "Automated": 200,
            "PlannedToAutomate": 155,
            "AutomationProgress": 129.0,
            "RollupWarningVisible": false
        },
        "Ace": {
            "Total": 220,
            "Automated": 180,
            "PlannedToAutomate": 140,
            "AutomationProgress": 128.6,
            "RollupWarningVisible": false
        },
        "Agency": {
            "Total": 120,
            "Automated": 85,
            "PlannedToAutomate": 82,
            "AutomationProgress": 103.7,
            "RollupWarningVisible": false
        }
    }
}'><code>Metric,Value
Avengers_Unit_Total,40
Avengers_Unit_PlannedToAutomate,35
Avengers_Unit_Automated,34
Avengers_Functional_Total,50
Avengers_Functional_PlannedToAutomate,42
Avengers_Functional_Automated,42
Avengers_IncrementalDataLoad_Total,20
Avengers_IncrementalDataLoad_PlannedToAutomate,18
Avengers_IncrementalDataLoad_Automated,17
Avengers_FullLoadDataValidation_Total,30
Avengers_FullLoadDataValidation_PlannedToAutomate,28
Avengers_FullLoadDataValidation_Automated,26
Avengers_UserAcceptance_Total,20
Avengers_UserAcceptance_PlannedToAutomate,18
Avengers_UserAcceptance_Automated,17
Avengers_API_Total,15
Avengers_API_PlannedToAutomate,14
Avengers_API_Automated,13
Avengers_Regression_Total,120
Avengers_Regression_PlannedToAutomate,14
Avengers_Regression_Automated,13
Avengers_Smoke_Total,10
Avengers_Smoke_PlannedToAutomate,8
Avengers_Smoke_Automated,8
Imaging_Unit_Total,60
Imaging_Unit_PlannedToAutomate,55
Imaging_Unit_Automated,52
Imaging_Functional_Total,80
Imaging_Functional_PlannedToAutomate,75
Imaging_Functional_Automated,70
Imaging_IncrementalDataLoad_Total,30
Imaging_IncrementalDataLoad_PlannedToAutomate,28
Imaging_IncrementalDataLoad_Automated,26
Imaging_FullLoadDataValidation_Total,40
Imaging_FullLoadDataValidation_PlannedToAutomate,38
Imaging_FullLoadDataValidation_Automated,36
Imaging_UserAcceptance_Total,30
Imaging_UserAcceptance_PlannedToAutomate,28
Imaging_UserAcceptance_Automated,26
Imaging_API_Total,20
Imaging_API_PlannedToAutomate,18
Imaging_API_Automated,17
Imaging_Regression_Total,100
Imaging_Regression_PlannedToAutomate,18
Imaging_Regression_Automated,17
Imaging_Smoke_Total,12
Imaging_Smoke_PlannedToAutomate,20
Imaging_Smoke_Automated,16
Phoenix_Unit_Total,50
Phoenix_Unit_PlannedToAutomate,45
Phoenix_Unit_Automated,40
Phoenix_Functional_Total,70
Phoenix_Functional_PlannedToAutomate,65
Phoenix_Functional_Automated,60
Phoenix_IncrementalDataLoad_Total,25
Phoenix_IncrementalDataLoad_PlannedToAutomate,22
Phoenix_IncrementalDataLoad_Automated,20
Phoenix_FullLoadDataValidation_Total,35
Phoenix_FullLoadDataValidation_PlannedToAutomate,32
Phoenix_FullLoadDataValidation_Automated,28
Phoenix_UserAcceptance_Total,25
Phoenix_UserAcceptance_PlannedToAutomate,22
Phoenix_UserAcceptance_Automated,20
Phoenix_API_Total,15
Phoenix_API_PlannedToAutomate,13
Phoenix_API_Automated,12
Phoenix_Regression_Total,50
Phoenix_Regression_PlannedToAutomate,13
Phoenix_Regression_Automated,10
Phoenix_Smoke_Total,19
Phoenix_Smoke_PlannedToAutomate,8
Phoenix_Smoke_Automated,10
Ace_Unit_Total,50
Ace_Unit_PlannedToAutomate,40
Ace_Unit_Automated,38
Ace_Functional_Total,70
Ace_Functional_PlannedToAutomate,60
Ace_Functional_Automated,55
Ace_IncrementalDataLoad_Total,25
Ace_IncrementalDataLoad_PlannedToAutomate,20
Ace_IncrementalDataLoad_Automated,18
Ace_FullLoadDataValidation_Total,35
Ace_FullLoadDataValidation_PlannedToAutomate,30
Ace_FullLoadDataValidation_Automated,27
Ace_UserAcceptance_Total,25
Ace_UserAcceptance_PlannedToAutomate,20
Ace_UserAcceptance_Automated,18
Ace_API_Total,15
Ace_API_PlannedToAutomate,10
Ace_API_Automated,9
Ace_Regression_Total,0
Ace_Regression_PlannedToAutomate,10
Ace_Regression_Automated,8
Ace_Smoke_Total,0
Ace_Smoke_PlannedToAutomate,10
Ace_Smoke_Automated,7
Agency_Unit_Total,15
Agency_Unit_PlannedToAutomate,12
Agency_Unit_Automated,10
Agency_Functional_Total,20
Agency_Functional_PlannedToAutomate,18
Agency_Functional_Automated,15
Agency_IncrementalDataLoad_Total,15
Agency_IncrementalDataLoad_PlannedToAutomate,12
Agency_IncrementalDataLoad_Automated,10
Agency_FullLoadDataValidation_Total,15
Agency_FullLoadDataValidation_PlannedToAutomate,12
Agency_FullLoadDataValidation_Automated,10
Agency_UserAcceptance_Total,15
Agency_UserAcceptance_PlannedToAutomate,12
Agency_UserAcceptance_Automated,10
Agency_API_Total,10
Agency_API_PlannedToAutomate,8
Agency_API_Automated,5
Agency_Regression_Total,20
Agency_Regression_PlannedToAutomate,18
Agency_Regression_Automated,15
Agency_Smoke_Total,10
Agency_Smoke_PlannedToAutomate,8
Agency_Smoke_Automated,10
</code></pre>
                        <div class="mt-2">
                            <a href="#" class="run-scenario-data text-blue-600 hover:underline text-sm font-semibold transition duration-200" data-scenario-id="scenario1CsvData" data-scenario-number="1">
                                Run Test Scenario 1
                            </a>
                        </div>
                        <h6 class="text-md font-medium text-gray-800 mb-1 mt-4">Expected Outcomes:</h6>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 ml-4">
                            <li>**Overall Automation Coverage:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests Currently Automated: **895**</li>
                                    <li>Tests Planned for Automation (Overall): **717**</li>
                                    <li>Overall Automation Progress: **124.8% (Green bar)**</li>
                                    <li>Overall Automation Warning: **Visible**</li>
                                </ul>
                            </li>
                            <li>**Avengers Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **305**</li>
                                    <li>Tests Automated: **170**</li>
                                    <li>Planned to Automate: **135**</li>
                                    <li>Automation Progress: **125.9% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Imaging Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **372**</li>
                                    <li>Tests Automated: **260**</li>
                                    <li>Planned to Automate: **205**</li>
                                    <li>Automation Progress: **126.8% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Phoenix Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **289**</li>
                                    <li>Tests Automated: **200**</li>
                                    <li>Planned to Automate: **155**</li>
                                    <li>Automation Progress: **129.0% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Ace Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **220**</li>
                                    <li>Tests Automated: **180**</li>
                                    <li>Planned to Automate: **140**</li>
                                    <li>Automation Progress: **128.6% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Agency Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **120**</li>
                                    <li>Tests Automated: **85**</li>
                                    <li>Planned to Automate: **82**</li>
                                    <li>Automation Progress: **103.7% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div class="mb-8">
                        <h5 class="text-lg font-semibold text-gray-900 mb-2">Scenario 2: Mixed Coverage (Green, Yellow, Red)</h5>
                        <p class="text-gray-700 mb-2">This scenario introduces varying levels of automation to see how the color coding and progress bars respond.</p>
                        <h6 class="text-md font-medium text-gray-800 mb-1">CSV Data:</h6>
                        <!-- This pre tag displays the CSV data for Scenario 2. Its content is text, not executable code. -->
                        <pre id="scenario2CsvData" class="bg-gray-100 p-2 rounded text-sm overflow-auto mb-2"
data-expected-metrics='{
    "overallAutomation": {
        "currentAutomatedCount": 645,
        "plannedAutomationCount": 700,
        "overallAutomationProgress": 92.1,
        "overallAutomationWarningVisible": false
    },
    "teams": {
        "Avengers": {
            "Total": 305,
            "Automated": 100,
            "PlannedToAutomate": 135,
            "AutomationProgress": 74.1,
            "RollupWarningVisible": false
        },
        "Imaging": {
            "Total": 372,
            "Automated": 260,
            "PlannedToAutomate": 205,
            "AutomationProgress": 126.8,
            "RollupWarningVisible": false
        },
        "Phoenix": {
            "Total": 289,
            "Automated": 130,
            "PlannedToAutomate": 155,
            "AutomationProgress": 83.9,
            "RollupWarningVisible": false
        },
        "Ace": {
            "Total": 220,
            "Automated": 100,
            "PlannedToAutomate": 130,
            "AutomationProgress": 76.9,
            "RollupWarningVisible": false
        },
        "Agency": {
            "Total": 120,
            "Automated": 55,
            "PlannedToAutomate": 75,
            "AutomationProgress": 73.3,
            "RollupWarningVisible": false
        }
    }
}'><code>Metric,Value
Avengers_Unit_Total,40
Avengers_Unit_PlannedToAutomate,35
Avengers_Unit_Automated,20
Avengers_Functional_Total,50
Avengers_Functional_PlannedToAutomate,25
Avengers_Functional_Automated,25
Avengers_IncrementalDataLoad_Total,20
Avengers_IncrementalDataLoad_PlannedToAutomate,18
Avengers_IncrementalDataLoad_Automated,10
Avengers_FullLoadDataValidation_Total,30
Avengers_FullLoadDataValidation_PlannedToAutomate,28
Avengers_FullLoadDataValidation_Automated,15
Avengers_UserAcceptance_Total,20
Avengers_UserAcceptance_PlannedToAutomate,18
Avengers_UserAcceptance_Automated,10
Avengers_API_Total,15
Avengers_API_PlannedToAutomate,14
Avengers_API_Automated,8
Avengers_Regression_Total,120
Avengers_Regression_PlannedToAutomate,14
Avengers_Regression_Automated,7
Avengers_Smoke_Total,10
Avengers_Smoke_PlannedToAutomate,8
Avengers_Smoke_Automated,5
Imaging_Total,300
Imaging_PlannedToAutomate,280
Imaging_Automated,260
Imaging_Unit_Total,60
Imaging_Unit_PlannedToAutomate,55
Imaging_Unit_Automated,52
Imaging_Functional_Total,80
Imaging_Functional_PlannedToAutomate,75
Imaging_Functional_Automated,70
Imaging_IncrementalDataLoad_Total,30
Imaging_IncrementalDataLoad_PlannedToAutomate,28
Imaging_IncrementalDataLoad_Automated,26
Imaging_FullLoadDataValidation_Total,40
Imaging_FullLoadDataValidation_PlannedToAutomate,38
Imaging_FullLoadDataValidation_Automated,36
Imaging_UserAcceptance_Total,30
Imaging_UserAcceptance_PlannedToAutomate,28
Imaging_UserAcceptance_Automated,26
Imaging_API_Total,20
Imaging_API_PlannedToAutomate,18
Imaging_API_Automated,17
Imaging_Regression_Total,100
Imaging_Regression_PlannedToAutomate,18
Imaging_Regression_Automated,17
Imaging_Smoke_Total,12
Imaging_Smoke_PlannedToAutomate,20
Imaging_Smoke_Automated,16
Phoenix_Unit_Total,50
Phoenix_Unit_PlannedToAutomate,45
Phoenix_Unit_Automated,25
Phoenix_Functional_Total,70
Phoenix_Functional_PlannedToAutomate,65
Phoenix_Functional_Automated,35
Phoenix_IncrementalDataLoad_Total,25
Phoenix_IncrementalDataLoad_PlannedToAutomate,22
Phoenix_IncrementalDataLoad_Automated,12
Phoenix_FullLoadDataValidation_Total,35
Phoenix_FullLoadDataValidation_PlannedToAutomate,32
Phoenix_FullLoadDataValidation_Automated,18
Phoenix_UserAcceptance_Total,25
Phoenix_UserAcceptance_PlannedToAutomate,22
Phoenix_UserAcceptance_Automated,12
Phoenix_API_Total,15
Phoenix_API_PlannedToAutomate,13
Phoenix_API_Automated,7
Phoenix_Regression_Total,50
Phoenix_Regression_PlannedToAutomate,13
Phoenix_Regression_Automated,7
Phoenix_Smoke_Total,19
Phoenix_Smoke_PlannedToAutomate,8
Phoenix_Smoke_Automated,14
Ace_Unit_Total,50
Ace_Unit_PlannedToAutomate,40
Ace_Unit_Automated,20
Ace_Functional_Total,70
Ace_Functional_PlannedToAutomate,60
Ace_Functional_Automated,30
Ace_IncrementalDataLoad_Total,25
Ace_IncrementalDataLoad_PlannedToAutomate,20
Ace_IncrementalDataLoad_Automated,10
Ace_FullLoadDataValidation_Total,35
Ace_FullLoadDataValidation_PlannedToAutomate,30
Ace_FullLoadDataValidation_Automated,15
Ace_UserAcceptance_Total,25
Ace_UserAcceptance_PlannedToAutomate,20
Ace_UserAcceptance_Automated,10
Ace_API_Total,15
Ace_API_PlannedToAutomate,10
Ace_API_Automated,5
Ace_Regression_Total,0
Ace_Regression_PlannedToAutomate,5
Ace_Regression_Automated,5
Ace_Smoke_Total,0
Ace_Smoke_PlannedToAutomate,5
Ace_Smoke_Automated,5
Agency_Unit_Total,15
Agency_Unit_PlannedToAutomate,10
Agency_Unit_Automated,5
Agency_Functional_Total,20
Agency_Functional_PlannedToAutomate,15
Agency_Functional_Automated,10
Agency_IncrementalDataLoad_Total,15
Agency_IncrementalDataLoad_PlannedToAutomate,10
Agency_IncrementalDataLoad_Automated,7
Agency_FullLoadDataValidation_Total,15
Agency_FullLoadDataValidation_PlannedToAutomate,10
Agency_FullLoadDataValidation_Automated,8
Agency_UserAcceptance_Total,15
Agency_UserAcceptance_PlannedToAutomate,10
Agency_UserAcceptance_Automated,5
Agency_API_Total,10
Agency_API_PlannedToAutomate,8
Agency_API_Automated,5
Agency_Regression_Total,20
Agency_Regression_PlannedToAutomate,15
Agency_Regression_Automated,10
Agency_Smoke_Total,10
Agency_Smoke_PlannedToAutomate,12
Agency_Smoke_Automated,5
</code></pre>
                        <div class="mt-2">
                            <a href="#" class="run-scenario-data text-blue-600 hover:underline text-sm font-semibold transition duration-200" data-scenario-id="scenario2CsvData" data-scenario-number="2">
                                Run Test Scenario 2
                            </a>
                        </div>
                        <h6 class="text-md font-medium text-gray-800 mb-1 mt-4">Expected Outcomes:</h6>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 ml-4">
                            <li>**Overall Automation Coverage:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests Currently Automated: **645**</li>
                                    <li>Tests Planned for Automation (Overall): **700**</li>
                                    <li>Overall Automation Progress: **92.1% (Green bar)**</li>
                                    <li>Overall Automation Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Avengers Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **305**</li>
                                    <li>Tests Automated: **100**</li>
                                    <li>Planned to Automate: **135**</li>
                                    <li>Automation Progress: **74.1% (Yellow bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Imaging Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **372**</li>
                                    <li>Tests Automated: **260**</li>
                                    <li>Planned to Automate: **205**</li>
                                    <li>Automation Progress: **126.8% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Phoenix Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **289**</li>
                                    <li>Tests Automated: **130**</li>
                                    <li>Planned to Automate: **155**</li>
                                    <li>Automation Progress: **83.9% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Ace Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **220**</li>
                                    <li>Tests Automated: **100**</li>
                                    <li>Planned to Automate: **130**</li>
                                    <li><li>Automation Progress: **76.9% (Yellow bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Agency Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **120**</li>
                                    <li>Tests Automated: **55**</li>
                                    <li>Planned to Automate: **75**</li>
                                    <li>Automation Progress: **73.3% (Yellow bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <div class="mb-8">
                        <h5 class="text-lg font-semibold text-gray-900 mb-2">Scenario 3: Data Inconsistencies (Triggering Warnings)</h5>
                        <p class="text-gray-700 mb-2">This scenario is designed to trigger both the overall "Automated &gt; Planned" warning and a team-specific "Roll-up Mismatch" warning (though the latter is now obsolete with calculated team totals).</p>
                        <h6 class="text-md font-medium text-gray-800 mb-1">CSV Data:</h6>
                        <!-- This pre tag displays the CSV data for Scenario 3. Its content is text, not executable code. -->
                        <pre id="scenario3CsvData" class="bg-gray-100 p-2 rounded text-sm overflow-auto mb-2"
data-expected-metrics='{
    "overallAutomation": {
        "currentAutomatedCount": 336,
        "plannedAutomationCount": 222,
        "overallAutomationProgress": 151.4,
        "overallAutomationWarningVisible": true
    },
    "teams": {
        "Avengers": {
            "Total": 215,
            "Automated": 104,
            "PlannedToAutomate": 55,
            "AutomationProgress": 189.1,
            "RollupWarningVisible": false
        },
        "Imaging": {
            "Total": 202,
            "Automated": 78,
            "PlannedToAutomate": 61,
            "AutomationProgress": 127.9,
            "RollupWarningVisible": false
        },
        "Phoenix": {
            "Total": 144,
            "Automated": 119,
            "PlannedToAutomate": 56,
            "AutomationProgress": 212.5,
            "RollupWarningVisible": false
        },
        "Ace": {
            "Total": 0,
            "Automated": 0,
            "PlannedToAutomate": 0,
            "AutomationProgress": 0.0,
            "RollupWarningVisible": false
        },
        "Agency": {

            "Total": 80,
            "Automated": 35,
            "PlannedToAutomate": 50,
            "AutomationProgress": 70.0,
            "RollupWarningVisible": false
        }
    }
}'><code>Metric,Value
Avengers_Unit_Total,20
Avengers_Unit_PlannedToAutomate,15
Avengers_Unit_Automated,15
Avengers_Functional_Total,30
Avengers_Functional_PlannedToAutomate,25
Avengers_Functional_Automated,25
Avengers_IncrementalDataLoad_Total,10
Avengers_IncrementalDataLoad_PlannedToAutomate,8
Avengers_IncrementalDataLoad_Automated,10
Avengers_FullLoadDataValidation_Total,15
Avengers_FullLoadDataValidation_PlannedToAutomate,12
Avengers_FullLoadDataValidation_Automated,15
Avengers_UserAcceptance_Total,10
Avengers_UserAcceptance_PlannedToAutomate,8
Avengers_UserAcceptance_Automated,10
Avengers_API_Total,5
Avengers_API_PlannedToAutomate,4
Avengers_API_Automated,5
Avengers_Regression_Total,120
Avengers_Regression_PlannedToAutomate,4
Avengers_Regression_Automated,4
Avengers_Smoke_Total,5
Avengers_Smoke_PlannedToAutomate,4
Avengers_Smoke_Automated,20
Imaging_Unit_Total,20
Imaging_Unit_PlannedToAutomate,18
Imaging_Unit_Automated,17
Imaging_Functional_Total,30
Imaging_Functional_PlannedToAutomate,27
Imaging_Functional_Automated,25
Imaging_IncrementalDataLoad_Total,10
Imaging_IncrementalDataLoad_PlannedToAutomate,9
Imaging_IncrementalDataLoad_Automated,8
Imaging_FullLoadDataValidation_Total,15
Imaging_FullLoadDataValidation_PlannedToAutomate,13
Imaging_FullLoadDataValidation_Automated,12
Imaging_UserAcceptance_Total,10
Imaging_UserAcceptance_PlannedToAutomate,9
Imaging_UserAcceptance_Automated,8
Imaging_API_Total,5
Imaging_API_PlannedToAutomate,4
Imaging_API_Automated,3
Imaging_Regression_Total,100
Imaging_Regression_PlannedToAutomate,4
Imaging_Regression_Automated,3
Imaging_Smoke_Total,12
Imaging_Smoke_PlannedToAutomate,4
Imaging_Smoke_Automated,2
Phoenix_Unit_Total,20
Phoenix_Unit_PlannedToAutomate,16
Phoenix_Unit_Automated,18
Phoenix_Functional_Total,30
Phoenix_Functional_PlannedToAutomate,24
Phoenix_Functional_Automated,30
Phoenix_IncrementalDataLoad_Total,10
Phoenix_IncrementalDataLoad_PlannedToAutomate,8
Phoenix_IncrementalDataLoad_Automated,12
Phoenix_FullLoadDataValidation_Total,0
Phoenix_FullLoadDataValidation_PlannedToAutomate,12
Phoenix_FullLoadDataValidation_Automated,18
Phoenix_UserAcceptance_Total,10
Phoenix_UserAcceptance_PlannedToAutomate,8
Phoenix_UserAcceptance_Automated,12
Phoenix_API_Total,5
Phoenix_API_PlannedToAutomate,4
Phoenix_API_Automated,7
Phoenix_Regression_Total,50
Phoenix_Regression_PlannedToAutomate,4
Phoenix_Regression_Automated,7
Phoenix_Smoke_Total,19
Phoenix_Smoke_PlannedToAutomate,4
Phoenix_Smoke_Automated,15
Ace_Unit_Total,0
Ace_Unit_PlannedToAutomate,0
Ace_Unit_Automated,0
Ace_Functional_Total,0
Ace_Functional_PlannedToAutomate,0
Ace_Functional_Automated,0
Ace_IncrementalDataLoad_Total,0
Ace_IncrementalDataLoad_PlannedToAutomate,0
Ace_IncrementalDataLoad_Automated,0
Ace_FullLoadDataValidation_Total,0
Ace_FullLoadDataValidation_PlannedToAutomate,0
Ace_FullLoadDataValidation_Automated,0
Ace_UserAcceptance_Total,0
Ace_UserAcceptance_PlannedToAutomate,0
Ace_UserAcceptance_Automated,0
Ace_API_Total,0
Ace_API_PlannedToAutomate,0
Ace_API_Automated,0
Ace_Regression_Total,0
Ace_Regression_PlannedToAutomate,0
Ace_Regression_Automated,0
Ace_Smoke_Total,0
Ace_Smoke_PlannedToAutomate,0
Ace_Smoke_Automated,0
Agency_Unit_Total,10
Agency_Unit_PlannedToAutomate,8
Agency_Unit_Automated,5
Agency_Functional_Total,10
Agency_Functional_PlannedToAutomate,8
Agency_Functional_Automated,5
Agency_IncrementalDataLoad_Total,10
Agency_IncrementalDataLoad_PlannedToAutomate,8
Agency_IncrementalDataLoad_Automated,5
Agency_FullLoadDataValidation_Total,10
Agency_FullLoadDataValidation_PlannedToAutomate,8
Agency_FullLoadDataValidation_Automated,5
Agency_UserAcceptance_Total,10
Agency_UserAcceptance_PlannedToAutomate,8
Agency_UserAcceptance_Automated,5
Agency_API_Total,10
Agency_API_PlannedToAutomate,8
Agency_API_Automated,5
Agency_Regression_Total,10
Agency_Regression_PlannedToAutomate,5
Agency_Regression_Automated,3
Agency_Smoke_Total,10
Agency_Smoke_PlannedToAutomate,5
Agency_Smoke_Automated,2
</code></pre>
                        <div class="mt-2">
                            <a href="#" class="run-scenario-data text-blue-600 hover:underline text-sm font-semibold transition duration-200" data-scenario-id="scenario3CsvData" data-scenario-number="3">
                                Run Test Scenario 3
                            </a>
                        </div>
                        <h6 class="text-md font-medium text-gray-800 mb-1 mt-4">Expected Outcomes:</h6>
                        <ul class="list-disc list-inside text-gray-700 space-y-1 ml-4">
                            <li>**Overall Automation Coverage:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests Currently Automated: **336**</li>
                                    <li>Tests Planned for Automation (Overall): **222**</li>
                                    <li>Overall Automation Progress: **151.4% (Green bar)**</li>
                                    <li>Overall Automation Warning: **Visible**</li>
                                </ul>
                            </li>
                            <li>**Avengers Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **215**</li>
                                    <li>Tests Automated: **104**</li>
                                    <li>Planned to Automate: **55**</li>
                                    <li>Automation Progress: **189.1% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Imaging Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **202**</li>
                                    <li>Tests Automated: **78**</li>
                                    <li>Planned to Automate: **61**</li>
                                    <li>Automation Progress: **127.9% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Phoenix Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **144**</li>
                                    <li>Tests Automated: **119**</li>
                                    <li>Planned to Automate: **56**</li>
                                    <li>Automation Progress: **212.5% (Green bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Ace Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **0**</li>
                                    <li>Tests Automated: **0**</li>
                                    <li>Planned to Automate: **0**</li>
                                    <li>Automation Progress: **0.0% (Red bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                            <li>**Agency Team:**
                                <ul class="list-circle list-inside ml-4">
                                    <li>Total Tests in Category: **80**</li>
                                    <li>Tests Automated: **35**</li>
                                    <li>Planned to Automate: **50**</li>
                                    <li>Automation Progress: **70.0% (Yellow bar)**</li>
                                    <li>Roll-up Warning: **Hidden**</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <p class="text-gray-700 mt-6">
                        After making changes to these constants, save the HTML file and refresh your browser to see the effects.
                    </p>
                </div>
                <!-- New Change Log Section -->
                <div class="mt-8">
                    <h3 class="text-2xl font-semibold text-gray-900 mb-4 border-b pb-2">Change Log</h3>
                    <div class="mb-6">
                        <h4 class="text-xl font-medium text-gray-800 mb-2">July 18, 2025</h4>
                        <ul class="list-disc list-inside text-gray-700 space-y-2">
                            <li>
                                **Removed Unused Export Functions:**
                                <p class="ml-4">
                                    **Explanation:** The `exportDataAsCsv()` and `exportDataAsJson()` functions were removed as they were not being used in the dashboard's current functionality. This reduces the overall code size and improves maintainability.
                                </p>
                            </li>
                            <li>
                                **Automated Calculation of Team-Level and Overall Metrics:**
                                <p class="ml-4">
                                    **Description:** Implemented automatic calculation for "Total Tests in Category," "Planned to Automate," and "Tests Automated" for each team, as well as the overall "Total Tests Currently Automated" and "Tests Planned for Automation (Overall)."
                                </p>
                                <p class="ml-4">
                                    **Explanation:** Previously, these aggregate metrics were expected as direct inputs in the CSV. Now, they are dynamically derived by summing their respective individual test type breakdown values (e.g., `Team_Total` is the sum of `Team_Unit_Total`, `Team_Functional_Total`, etc.). This eliminates manual data entry for these totals, ensuring consistency and reducing potential errors. The "Planned to Automate" calculation for teams and overall explicitly excludes Functional Tests, which now display "N/A" for their planned count. Consequently, the "Roll-up Warning" (which checked for discrepancies between CSV-provided team totals and calculated sums) has been removed as it is no longer applicable. The `HARDCODED_CSV_DATA`, `CSV_EXAMPLE_DATA`, and all regression scenario `data-expected-metrics` have been updated to reflect these new calculated values.
                                </p>
                            </li>
                            <li>
                                **Corrected Individual Test Type Progress Bar Calculation:**
                                <p class="ml-4">
                                    **Explanation:** Changed the calculation for `testTypeCoverage` within `updateTeamCard` from `(testTypeAutomated / testTypePlannedToAutomate) * 100` to `(testTypeAutomated / testTypeTotal) * 100`. This ensures that the percentage for each individual test type's progress bar is correctly calculated based on the number of automated tests relative to the total tests for that specific type, as per user feedback.
                                </p>
                            </li>
                            <li>
                                **Clarified "Tests Automated" Definition in How-To:**
                                <p class="ml-4">
                                    **Explanation:** Updated the "How to Use This Dashboard" section to explicitly clarify that the "Tests Automated" number displayed on each team card is the *sum of its breakdown test types*, and this is the value used for the team's automation progress percentage.
                                </p>
                            </li>
                            <li>
                                **Enhanced Console Logs for Validation:**
                                <p class="ml-4">
                                    **Explanation:** Modified the `validateScenario` function's console logs to more clearly present the "Tests Automated (from Breakdown Sum)" for each team, alongside the "Planned to Automate" and the calculated "Automation Progress %". Added `toFixed(2)` to the difference in progress for better readability in logs.
                                </p>
                            </li>
                            <li>
                                **Removed On-Screen "Passed!" / "Failed!" Messages:**
                                <p class="ml-4">
                                    **Explanation:** The `showConfirmation` calls for test scenario outcomes have been removed. All validation results are now exclusively logged to the browser's developer console for debugging purposes, addressing the user's feedback about confusing on-screen messages.
                                </p>
                            </li>
                            <li>
                                **Added Explicit HTML Comment for Script Block:**
                                <p class="ml-4">
                                    **Explanation:** Added an HTML comment directly before the main JavaScript `&lt;script&gt;` block to explicitly state that its content is JavaScript and should not be visible in the rendered UI. This is to help diagnose potential browser rendering issues if the script content appears on the page.
                                </p>
                            </li>
                            <li>
                                **Added Robust Parsing with .replace(/\D/g, ''):**
                                <p class="ml-4">
                                    **Explanation:** Implemented `replace(/\D/g, '')` on `textContent` when parsing numeric values from the DOM within the `validateScenario` function. This ensures that any non-digit characters (including commas or non-breaking spaces introduced by `toLocaleString()`) are removed, preventing potential parsing errors and improving the reliability of numerical comparisons during validation.
                                </p>
                            </li>
                            <li>
                                **Added Detailed Console Logs for Debugging:**
                                <p class="ml-4">
                                    **Explanation:** Added `console.log` statements in `updateTeamCard` to show the `calculatedTeamAutomated` value before it's set to the DOM, and in `validateScenario` to show the `actualAutomated` value read from the DOM. This provides more visibility into the data flow and helps diagnose why validation might be failing.
                                </p>
                            </li>
                            <li>
                                **Refactored Test Scenario Links and Messages:**
                                <p class="ml-4">
                                    **Explanation:** The "Run Test Scenario" links now include their corresponding scenario numbers (e.g., "Run Test Scenario 1"). The overlay messages displayed after running a scenario have also been updated to include the specific test scenario number (e.g., "Test Scenario 1 Passed!" or "Test Scenario 2 Failed!"), providing clearer feedback to the user.
                                </p>
                            </li>
                            <li>
                                **Clarified Dashboard Warning Messages:**
                                <p class="ml-4">
                                    **Explanation:** The "Understanding Dashboard Warnings" section has been updated to explicitly cover both the "Overall Automation Warning" and the "Team-Specific Roll-up Warning." This provides a comprehensive explanation of what each warning means, why it might appear (including data entry errors and inconsistencies), and what steps users should take to resolve them. This ensures all potential red warning messages are clearly documented for better user understanding and troubleshooting.
                                </p>
                            </li>
                            <li>
                                **Implemented Dynamic Team Card Generation:**
                                <p class="ml-4">
                                    **Explanation:** The HTML for each team card is no longer hardcoded. Instead, the `initializeDashboard` function now iterates through a `teamNames` array and calls the `createTeamCardHtml` function for each team. This function dynamically generates the HTML structure for each team's card, significantly reducing HTML redundancy and making it easier to add or remove teams.
                                </p>
                            </li>
                            <li>
                                **Implemented Centralized Team Data Processing:**
                                <p class="ml-4">
                                    **Explanation:** The `applyData` function now iterates through the `teamNames` array and calls a dedicated `updateTeamCard` function for each team. The `updateTeamCard` function encapsulates all the logic for updating a single team's metrics, progress bars, and breakdown. This centralizes data processing logic, improving modularity and maintainability.
                                </p>
                            </li>
                            <li>
                                **Added Helper Functions for Styling:**
                                <p class="ml-4">
                                    **Explanation:** Two new helper functions were introduced for consistent styling:
                                    <ul class="list-circle list-inside ml-4">
                                        <li>`getProgressBarColorClass(percentage)`: Determines the appropriate Tailwind CSS class (e.g., `bg-green-600`, `bg-yellow-600`, `bg-red-600`) for progress bar colors based on a given automation percentage.</li>
                                        <li>`getCardColorClasses(percentage)`: Determines the background and border Tailwind CSS classes (e.g., `bg-green-50`, `border-green-200`) for team cards based on their overall automation percentage.</li>
                                    </ul>
                                </p>
                            </li>
                            <li>
                                **Refactored `loadDefaultRandomData`:**
                                <p class="ml-4">
                                    **Explanation:** The `loadDefaultRandomData` function was updated to correctly generate data for the new 'Agency' team and to align with the dynamic card generation process. This ensures that when random data is loaded, it properly populates all defined teams and their respective metrics.
                                </p>
                            </li>
                            <li>
                                **Streamlined Regression Test Data Loading:**
                                <p class="ml-4">
                                    **Explanation:** The manual "Copy CSV Data" links for regression test scenarios have been replaced with "Run Test Scenario" links. Clicking these links now automatically loads the corresponding CSV data into the dashboard. After loading, the page automatically scrolls to the top, allowing users to immediately view and validate the updated dashboard metrics against the expected outcomes for each scenario, significantly simplifying the testing workflow.
                                </p>
                            </li>
                            <li>
                                **Refactored Clipboard Copy Logic into Reusable Function:**
                                <p class="ml-4">
                                    **Explanation:** The logic responsible for copying text to the clipboard (previously used by the "Copy Sample Data" link) has been extracted into a new, reusable function named `copyTextToClipboard(text, confirmElement)`. This improves code modularity and readability. Now, any part of the dashboard needing to copy text can simply call this function, passing the desired text and an element to display a temporary "Copied!" message.
                                </p>
                            </li>
                            <li>
                                **Fixed data loading and missing team cards issue:**
                                <p class="ml-4">
                                    **Explanation:** The dashboard previously experienced issues where the default dataset wasn't loading and test team cards were missing. This was due to HTML closing tags (`<code>` and `</code>`) being inadvertently included *inside* JavaScript string literals (`HARDCODED_CSV_DATA` and `CSV_EXAMPLE_DATA`). This caused JavaScript syntax errors ("Unexpected end of input" / "Unexpected )"), preventing the `parseCSV` function from correctly reading data and subsequently impacting the `initializeDashboard` and `applyData` functions from generating and populating team cards. The fix involved removing these extraneous HTML tags from within the JavaScript string literals, ensuring the strings contain only raw CSV data.
                                </p>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

        </main>

        <footer class="bg-gray-800 text-white p-4 text-center text-sm mt-8 rounded-t-lg">
            <p>&copy; 2025 Enterprise Applications - Automation Dashboard. Data as of <span id="currentDate"></span>.</p>
        </footer>
    </div>

    <!-- IMPORTANT: The following block contains JavaScript code and should not be visible in the browser's rendered UI. -->
    <!-- If you are seeing this code on the page, there might be an issue with your browser's HTML parsing. -->
    <script>
        // --- Configuration for Color Thresholds ---
        const GREEN_THRESHOLD = 80; // Percentage above which progress is considered 'green'
        const YELLOW_THRESHOLD = 50; // Percentage above which progress is considered 'yellow' (and below green)

        // --- Configuration for Data Loading ---
        // Set this to 'true' to load data from the HARDCODED_CSV_DATA string when the page first loads.
        // Set to 'false' to load random data initially (and then rely on the UI 'Load Data' button).
        const LOAD_FROM_HARDCODED_ON_STARTUP = true;

        // This is your hardcoded CSV data. You can paste content from your sample-data.csv here.
        // NOTE: Due to browser security, you cannot directly load from a local file path like C:\temp\rawdata.csv.
        // This string serves as the "hardcoded" data source.
        const HARDCODED_CSV_DATA = `Metric,Value
Avengers_Unit_Total,40
Avengers_Unit_PlannedToAutomate,35
Avengers_Unit_Automated,34
Avengers_Functional_Total,50
Avengers_Functional_PlannedToAutomate,42
Avengers_Functional_Automated,42
Avengers_IncrementalDataLoad_Total,20
Avengers_IncrementalDataLoad_PlannedToAutomate,18
Avengers_IncrementalDataLoad_Automated,17
Avengers_FullLoadDataValidation_Total,30
Avengers_FullLoadDataValidation_PlannedToAutomate,28
Avengers_FullLoadDataValidation_Automated,26
Avengers_UserAcceptance_Total,20
Avengers_UserAcceptance_PlannedToAutomate,18
Avengers_UserAcceptance_Automated,17
Avengers_API_Total,15
Avengers_API_PlannedToAutomate,14
Avengers_API_Automated,13
Avengers_Regression_Total,120
Avengers_Regression_PlannedToAutomate,14
Avengers_Regression_Automated,13
Avengers_Smoke_Total,10
Avengers_Smoke_PlannedToAutomate,8
Avengers_Smoke_Automated,8
Imaging_Unit_Total,60
Imaging_Unit_PlannedToAutomate,55
Imaging_Unit_Automated,52
Imaging_Functional_Total,80
Imaging_Functional_PlannedToAutomate,75
Imaging_Functional_Automated,70
Imaging_IncrementalDataLoad_Total,30
Imaging_IncrementalDataLoad_PlannedToAutomate,28
Imaging_IncrementalDataLoad_Automated,26
Imaging_FullLoadDataValidation_Total,40
Imaging_FullLoadDataValidation_PlannedToAutomate,38
Imaging_FullLoadDataValidation_Automated,36
Imaging_UserAcceptance_Total,30
Imaging_UserAcceptance_PlannedToAutomate,28
Imaging_UserAcceptance_Automated,26
Imaging_API_Total,20
Imaging_API_PlannedToAutomate,18
Imaging_API_Automated,17
Imaging_Regression_Total,100
Imaging_Regression_PlannedToAutomate,18
Imaging_Regression_Automated,17
Imaging_Smoke_Total,12
Imaging_Smoke_PlannedToAutomate,20
Imaging_Smoke_Automated,16
Phoenix_Unit_Total,50
Phoenix_Unit_PlannedToAutomate,45
Phoenix_Unit_Automated,40
Phoenix_Functional_Total,70
Phoenix_Functional_PlannedToAutomate,65
Phoenix_Functional_Automated,60
Phoenix_IncrementalDataLoad_Total,25
Phoenix_IncrementalDataLoad_PlannedToAutomate,22
Phoenix_IncrementalDataLoad_Automated,20
Phoenix_FullLoadDataValidation_Total,35
Phoenix_FullLoadDataValidation_PlannedToAutomate,32
Phoenix_FullLoadDataValidation_Automated,28
Phoenix_UserAcceptance_Total,25
Phoenix_UserAcceptance_PlannedToAutomate,22
Phoenix_UserAcceptance_Automated,20
Phoenix_API_Total,15
Phoenix_API_PlannedToAutomate,13
Phoenix_API_Automated,12
Phoenix_Regression_Total,50
Phoenix_Regression_PlannedToAutomate,13
Phoenix_Regression_Automated,10
Phoenix_Smoke_Total,19
Phoenix_Smoke_PlannedToAutomate,8
Phoenix_Smoke_Automated,10
Ace_Unit_Total,50
Ace_Unit_PlannedToAutomate,40
Ace_Unit_Automated,38
Ace_Functional_Total,70
Ace_Functional_PlannedToAutomate,60
Ace_Functional_Automated,55
Ace_IncrementalDataLoad_Total,25
Ace_IncrementalDataLoad_PlannedToAutomate,20
Ace_IncrementalDataLoad_Automated,18
Ace_FullLoadDataValidation_Total,35
Ace_FullLoadDataValidation_PlannedToAutomate,30
Ace_FullLoadDataValidation_Automated,27
Ace_UserAcceptance_Total,25
Ace_UserAcceptance_PlannedToAutomate,20
Ace_UserAcceptance_Automated,18
Ace_API_Total,15
Ace_API_PlannedToAutomate,10
Ace_API_Automated,9
Ace_Regression_Total,0
Ace_Regression_PlannedToAutomate,10
Ace_Regression_Automated,8
Ace_Smoke_Total,0
Ace_Smoke_PlannedToAutomate,10
Ace_Smoke_Automated,7
Agency_Unit_Total,15
Agency_Unit_PlannedToAutomate,12
Agency_Unit_Automated,10
Agency_Functional_Total,20
Agency_Functional_PlannedToAutomate,18
Agency_Functional_Automated,15
Agency_IncrementalDataLoad_Total,15
Agency_IncrementalDataLoad_PlannedToAutomate,12
Agency_IncrementalDataLoad_Automated,10
Agency_FullLoadDataValidation_Total,15
Agency_FullLoadDataValidation_PlannedToAutomate,12
Agency_FullLoadDataValidation_Automated,10
Agency_UserAcceptance_Total,15
Agency_UserAcceptance_PlannedToAutomate,12
Agency_UserAcceptance_Automated,10
Agency_API_Total,10
Agency_API_PlannedToAutomate,8
Agency_API_Automated,5
Agency_Regression_Total,20
Agency_Regression_PlannedToAutomate,18
Agency_Regression_Automated,15
Agency_Smoke_Total,10
Agency_Smoke_PlannedToAutomate,8
Agency_Smoke_Automated,10
`;

        const CSV_EXAMPLE_DATA = `Metric,Value
Avengers_Unit_Total,0
Avengers_Unit_PlannedToAutomate,0
Avengers_Unit_Automated,0
Avengers_Functional_Total,0
Avengers_Functional_PlannedToAutomate,0
Avengers_Functional_Automated,0
Avengers_IncrementalDataLoad_Total,0
Avengers_IncrementalDataLoad_PlannedToAutomate,0
Avengers_IncrementalDataLoad_Automated,0
Avengers_FullLoadDataValidation_Total,0
Avengers_FullLoadDataValidation_PlannedToAutomate,0
Avengers_FullLoadDataValidation_Automated,0
Avengers_UserAcceptance_Total,0
Avengers_UserAcceptance_PlannedToAutomate,0
Avengers_UserAcceptance_Automated,0
Avengers_API_Total,0
Avengers_API_PlannedToAutomate,0
Avengers_API_Automated,0
Avengers_Regression_Total,120
Avengers_Regression_PlannedToAutomate,90
Avengers_Regression_Automated,37
Avengers_Smoke_Total,0
Avengers_Smoke_PlannedToAutomate,0
Avengers_Smoke_Automated,0
Imaging_Unit_Total,0
Imaging_Unit_PlannedToAutomate,0
Imaging_Unit_Automated,0
Imaging_Functional_Total,0
Imaging_Functional_PlannedToAutomate,0
Imaging_Functional_Automated,0
Imaging_IncrementalDataLoad_Total,0
Imaging_IncrementalDataLoad_PlannedToAutomate,0
Imaging_IncrementalDataLoad_Automated,0
Imaging_FullLoadDataValidation_Total,0
Imaging_FullLoadDataValidation_PlannedToAutomate,0
Imaging_FullLoadDataValidation_Automated,0
Imaging_UserAcceptance_Total,0
Imaging_UserAcceptance_PlannedToAutomate,0
Imaging_UserAcceptance_Automated,0
Imaging_API_Total,0
Imaging_API_PlannedToAutomate,0
Imaging_API_Automated,0
Imaging_Regression_Total,100
Imaging_Regression_PlannedToAutomate,50
Imaging_Regression_Automated,0
Imaging_Smoke_Total,12
Imaging_Smoke_PlannedToAutomate,0
Imaging_Smoke_Automated,0
Phoenix_Unit_Total,0
Phoenix_Unit_PlannedToAutomate,0
Phoenix_Unit_Automated,0
Phoenix_Functional_Total,0
Phoenix_Functional_PlannedToAutomate,0
Phoenix_Functional_Automated,0
Phoenix_IncrementalDataLoad_Total,0
Phoenix_IncrementalDataLoad_PlannedToAutomate,0
Phoenix_IncrementalDataLoad_Automated,0
Phoenix_FullLoadDataValidation_Total,0
Phoenix_FullLoadDataValidation_PlannedToAutomate,0
Phoenix_FullLoadDataValidation_Automated,0
Phoenix_UserAcceptance_Total,0
Phoenix_UserAcceptance_PlannedToAutomate,0
Phoenix_UserAcceptance_Automated,0
Phoenix_API_Total,0
Phoenix_API_PlannedToAutomate,0
Phoenix_API_Automated,0
Phoenix_Regression_Total,50
Phoenix_Regression_PlannedToAutomate,10
Phoenix_Regression_Automated,0
Phoenix_Smoke_Total,19
Phoenix_Smoke_PlannedToAutomate,0
Phoenix_Smoke_Automated,0
Ace_Unit_Total,0
Ace_Unit_PlannedToAutomate,0
Ace_Unit_Automated,0
Ace_Functional_Total,0
Ace_Functional_PlannedToAutomate,0
Ace_Functional_Automated,0
Ace_IncrementalDataLoad_Total,0
Ace_IncrementalDataLoad_PlannedToAutomate,0
Ace_IncrementalDataLoad_Automated,0
Ace_FullLoadDataValidation_Total,0
Ace_FullLoadDataValidation_PlannedToAutomate,0
Ace_FullLoadDataValidation_Automated,0
Ace_UserAcceptance_Total,0
Ace_UserAcceptance_PlannedToAutomate,0
Ace_UserAcceptance_Automated,0
Ace_API_Total,0
Ace_API_PlannedToAutomate,0
Ace_API_Automated,0
Ace_Regression_Total,0
Ace_Regression_PlannedToAutomate,0
Ace_Regression_Automated,0
Ace_Smoke_Total,0
Ace_Smoke_PlannedToAutomate,0
Ace_Smoke_Automated,0
Agency_Unit_Total,0
Agency_Unit_PlannedToAutomate,0
Agency_Unit_Automated,0
Agency_Functional_Total,0
Agency_Functional_PlannedToAutomate,0
Agency_Functional_Automated,0
Agency_IncrementalDataLoad_Total,0
Agency_IncrementalDataLoad_PlannedToAutomate,0
Agency_IncrementalDataLoad_Automated,0
Agency_FullLoadDataValidation_Total,0
Agency_FullLoadDataValidation_PlannedToAutomate,0
Agency_FullLoadDataValidation_Automated,0
Agency_UserAcceptance_Total,0
Agency_UserAcceptance_PlannedToAutomate,0
Agency_UserAcceptance_Automated,0
Agency_API_Total,0
Agency_API_PlannedToAutomate,0
Agency_API_Automated,0
Agency_Regression_Total,0
Agency_Regression_PlannedToAutomate,0
Agency_Regression_Automated,0
Agency_Smoke_Total,13
Agency_Smoke_PlannedToAutomate,0
Agency_Smoke_Automated,0
`;


        document.addEventListener('DOMContentLoaded', initializeDashboard);

        // Global variable to store the last loaded data
        let currentDashboardData = {};

        // Define team names and their display names. This array controls which teams appear on the dashboard.
        const teamNames = [
            { prefix: 'Avengers', displayName: 'Avengers Team' },
            { prefix: 'Imaging', displayName: 'Imaging Team' },
            { prefix: 'Phoenix', displayName: 'Phoenix Team' },
            { prefix: 'Ace', displayName: 'Ace Team' },
            { prefix: 'Agency', displayName: 'Agency Team' } // New team added
        ];

        // Define test type names for iteration and display
        const testTypeDisplayNames = {
            'Unit': 'Unit Tests',
            'Functional': 'Functional Tests',
            'IncrementalDataLoad': 'Incremental Data Load Tests',
            'FullLoadDataValidation': 'Full Load Data Validation Tests',
            'UserAcceptance': 'User Acceptance Tests',
            'API': 'API Tests',
            'Regression': 'Regression Tests',
            'Smoke': 'Smoke Tests'
        };
        const testTypeMetricPrefixes = Object.keys(testTypeDisplayNames); // e.g., ['Unit', 'Functional', ...]

        /**
         * Helper function to display a temporary confirmation or error message in the overlay.
         * @param {string} message - The text message to display.
         * @param {boolean} [isError=false] - If true, the message will be styled as an error (red background).
         * @param {number|null} [scenarioNumber=null] - The number of the test scenario, if applicable.
         */
        function showConfirmation(message, isError = false, scenarioNumber = null) {
            const overlay = document.getElementById('dashboardMessageOverlay');
            if (!overlay) {
                console.error("Dashboard message overlay element not found!");
                return;
            }

            let displayMessage = message;
            if (scenarioNumber !== null) {
                displayMessage = `Test Scenario ${scenarioNumber} ${message}`;
            }

            overlay.textContent = displayMessage;
            overlay.classList.remove('bg-green-800', 'bg-red-800', 'hidden'); // Remove previous colors and hidden class
            overlay.classList.add(isError ? 'bg-red-800' : 'bg-green-800'); // Apply new color
            overlay.style.opacity = '1'; // Ensure it's fully visible
            overlay.style.pointerEvents = 'auto'; // Allow interaction if needed, though for a message, 'none' is often better.

            // Set timeout to start fading after 9 seconds (10 seconds total display)
            setTimeout(() => {
                overlay.style.opacity = '0'; // Start fade out
                // After fade out, hide the element completely
                setTimeout(() => {
                    overlay.classList.add('hidden');
                    overlay.style.pointerEvents = 'none'; // Prevent blocking clicks when hidden
                }, 1000); // This matches the transition duration (1s)
            }, 9000); // Message visible for 9 seconds before fading
        }

        /**
         * Initializes the dashboard: sets current date, loads initial data,
         * generates team cards dynamically, and sets up event listeners.
         */
        function initializeDashboard() {
            // Set current date in footer
            const today = new Date();
            document.getElementById('currentDate').textContent = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });

            // Dynamically generate team cards
            const teamCardsContainer = document.getElementById('teamCardsContainer');
            teamCardsContainer.innerHTML = ''; // Clear existing content
            teamNames.forEach(team => {
                teamCardsContainer.innerHTML += createTeamCardHtml(team.prefix, team.displayName);
            });

            // Load initial data based on configuration flag
            if (LOAD_FROM_HARDCODED_ON_STARTUP) {
                applyData(parseCSV(HARDCODED_CSV_DATA));
            } else {
                loadDefaultRandomData();
            }

            // Set the CSV example data in the textarea
            document.getElementById('csvExampleData').textContent = CSV_EXAMPLE_DATA;

            // Event listener for the Load Data button (always active to allow manual updates)
            document.getElementById('loadDataBtn').addEventListener('click', () => {
                const csvInput = document.getElementById('csvInput').value;
                const parsed = parseCSV(csvInput);
                // No specific element for dataLoadMessage, use the global overlay
                if (Object.keys(parsed).length > 0) {
                    applyData(parsed);
                    showConfirmation('Data loaded successfully!');
                } else {
                    showConfirmation('No valid data found in CSV. Please check format.', true);
                }
            });

            // Event listener for the Copy CSV Example link
            document.getElementById('copyCsvExampleLink').addEventListener('click', (event) => {
                event.preventDefault(); // Prevent default anchor link behavior
                const csvExampleData = document.getElementById('csvExampleData').textContent;
                // No specific element for copyConfirmMessage, use the global overlay
                copyTextToClipboard(csvExampleData);
            });

            // Add event listeners for scenario specific "Run Test Scenario" links
            document.querySelectorAll('.run-scenario-data').forEach(link => {
                link.addEventListener('click', (event) => {
                    event.preventDefault();
                    const scenarioId = event.target.dataset.scenarioId;
                    const scenarioNumber = event.target.dataset.scenarioNumber; // Get scenario number
                    const csvDataElement = document.getElementById(scenarioId);
                    const csvData = csvDataElement.textContent;

                    const parsed = parseCSV(csvData);
                    if (Object.keys(parsed).length > 0) {
                        applyData(parsed);

                        // Get expected metrics from data-expected-metrics attribute
                        const expectedMetricsJson = csvDataElement.dataset.expectedMetrics;
                        if (expectedMetricsJson) {
                            try {
                                const expectedMetrics = JSON.parse(expectedMetricsJson);
                                // Removed showConfirmation for Passed/Failed scenarios
                                validateScenario(expectedMetrics, currentDashboardData); // Still run validation and log to console
                            } catch (e) {
                                console.error("Error parsing expected metrics JSON:", e);
                                showConfirmation('Error in scenario data!', true, scenarioNumber); // Keep error message for parsing issues
                            }
                        } else {
                            showConfirmation('No expected metrics defined for this scenario.', true, scenarioNumber); // Keep error message for missing expected data
                        }

                        // Scroll to the top of the page after loading data
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    } else {
                        showConfirmation('Error loading data!', true, scenarioNumber); // Keep error message for data loading issues
                    }
                });
            });

            // Event listener for the new toggle breakdown links using event delegation on the container
            teamCardsContainer.addEventListener('click', (event) => {
                if (event.target.classList.contains('toggle-breakdown-link')) {
                    event.preventDefault();
                    const targetId = event.target.dataset.target;
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        targetElement.classList.toggle('hidden');
                        if (targetElement.classList.contains('hidden')) {
                            event.target.textContent = 'Click to see Breakdown by Test Type';
                        } else {
                            event.target.textContent = 'Hide Breakdown by Test Type';
                        }
                    }
                }
            });
        }

        /**
         * Generates the HTML string for a single team card.
         * @param {string} prefix - The unique prefix for the team (e.g., 'Avengers').
         * @param {string} displayName - The display name of the team (e.g., 'Avengers Team').
         * @returns {string} The HTML string for the team card.
         */
        function createTeamCardHtml(prefix, displayName) {
            const lowerCasePrefix = prefix.toLowerCase();
            return `
                <div id="${lowerCasePrefix}Card" class="test-type-card p-5 rounded-lg shadow-sm border">
                    <h4 class="text-xl font-medium text-gray-800 mb-3">${displayName}</h4>
                    <div class="space-y-1">
                        <p class="text-gray-700">Total Tests in Category: <span id="${lowerCasePrefix}Total" class="font-semibold">0</span></p>
                        <p class="text-indigo-600">Planned to Automate: <span id="${lowerCasePrefix}PlannedToAutomate" class="font-semibold">0</span></p>
                        <p class="text-blue-600">Tests Automated: <span id="${lowerCasePrefix}Automated" class="font-semibold">0</span></p>
                        <div class="mt-2">
                            <h5 class="text-md font-medium text-gray-800 mb-1">
                                <a href="#" class="toggle-breakdown-link text-blue-600 hover:underline text-sm" data-target="${lowerCasePrefix}TestTypeBreakdownContent">
                                    Hide Breakdown by Test Type
                                </a>
                            </h5>
                            <div id="${lowerCasePrefix}TestTypeBreakdownContent" class="space-y-1 text-sm">
                                <div id="${lowerCasePrefix}TestTypeBreakdown">
                                    <!-- Test type breakdown will be dynamically inserted here -->
                                </div>
                            </div>
                            <div id="${lowerCasePrefix}RollupWarning" class="mt-2 text-red-600 font-semibold text-xs hidden">
                                <!-- This warning is now obsolete as team totals are calculated -->
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        /**
         * Returns the appropriate Tailwind CSS class for a progress bar color based on percentage.
         * @param {number} percentage - The automation percentage.
         * @returns {string} Tailwind CSS color class.
         */
        function getProgressBarColorClass(percentage) {
            if (percentage > GREEN_THRESHOLD) {
                return 'bg-green-600';
            } else if (percentage > YELLOW_THRESHOLD) {
                return 'bg-yellow-600';
            } else {
                return 'bg-red-600';
            }
        }

        /**
         * Returns the appropriate Tailwind CSS classes for a card's background and border color based on percentage.
         * @param {number} percentage - The automation percentage.
         * @returns {object} An object with `bgColorClass` and `borderColorClass` properties.
         */
        function getCardColorClasses(percentage) {
            let bgColorClass, borderColorClass;
            if (percentage > GREEN_THRESHOLD) {
                bgColorClass = 'bg-green-50';
                borderColorClass = 'border-green-200';
            } else if (percentage > YELLOW_THRESHOLD) {
                bgColorClass = 'bg-yellow-50';
                borderColorClass = 'border-yellow-200';
            } else {
                bgColorClass = 'bg-red-50';
                borderColorClass = 'border-red-200';
            }
            return { bgColorClass, borderColorClass };
        }

        /**
         * Helper function to generate random data for demonstration.
         * This function is primarily for initial random loading if LOAD_FROM_HARDCODED_ON_STARTUP is false.
         */
        function loadDefaultRandomData() {
            function generateRandomMetric(baseTotal) {
                const total = Math.floor(baseTotal * (0.8 + Math.random() * 0.4)); // +/- 20%
                const plannedToAutomate = Math.floor(total * (0.5 + Math.random() * 0.5));
                const automated = Math.floor(plannedToAutomate * (0.3 + Math.random() * 0.6)); // Wide range for colors
                return { total, plannedToAutomate, automated };
            }

            const data = {};

            teamNames.forEach(team => {
                const teamPrefix = team.prefix;
                
                testTypeMetricPrefixes.forEach(testType => {
                    const metrics = generateRandomMetric(100); // Base for individual test types
                    data[`${teamPrefix}_${testType}_Total`] = metrics.total;
                    data[`${teamPrefix}_${testType}_PlannedToAutomate`] = metrics.plannedToAutomate;
                    data[`${teamPrefix}_${testType}_Automated`] = metrics.automated;
                });
            });

            applyData(data);
        }

        /**
         * Parses a CSV string into a data object.
         * @param {string} csvString - The CSV data as a string.
         * @returns {object} An object where keys are metric names and values are their integer values.
         */
        function parseCSV(csvString) {
            const parsedData = {};
            const lines = csvString.trim().split('\n');

            if (lines.length < 2) {
                console.warn('CSV string is empty or has no data rows.');
                return parsedData;
            }

            // Skip header line and parse data lines
            for (let i = 1; i < lines.length; i++) {
                const parts = lines[i].split(',');
                if (parts.length === 2) {
                    const metric = parts[0].trim();
                    const value = parseInt(parts[1].trim(), 10);
                    if (!isNaN(value)) {
                        parsedData[metric] = value;
                    } else {
                        console.warn(`Skipping invalid value for metric "${metric}": ${parts[1].trim()}`);
                    }
                }
            }
            return parsedData;
        }

        /**
         * Applies the parsed data to update all dashboard elements.
         * @param {object} data - The data object parsed from CSV.
         */
        function applyData(data) {
            currentDashboardData = data; // Update global data

            let totalCurrentlyAutomatedOverall = 0;
            let totalPlannedToAutomateOverall = 0;
            let totalTestsOverall = 0;

            // Process each team's data
            teamNames.forEach(team => {
                const { calculatedAutomated, calculatedPlannedToAutomate, calculatedTotal } = updateTeamCard(team.prefix, data);
                totalCurrentlyAutomatedOverall += calculatedAutomated;
                totalPlannedToAutomateOverall += calculatedPlannedToAutomate;
                totalTestsOverall += calculatedTotal;
            });

            // Update Overall Automation Coverage Metrics
            document.getElementById('currentAutomatedCount').textContent = totalCurrentlyAutomatedOverall.toLocaleString();
            document.getElementById('plannedAutomationCount').textContent = totalPlannedToAutomateOverall.toLocaleString();

            const overallAutomationProgress = totalPlannedToAutomateOverall > 0 ? (totalCurrentlyAutomatedOverall / totalPlannedToAutomateOverall) * 100 : 0;
            const overallAutomationProgressBar = document.getElementById('overallAutomationProgressBar');
            const overallAutomationProgressText = document.getElementById('overallAutomationProgressText');
            const overallAutomationWarning = document.getElementById('overallAutomationWarning');

            overallAutomationProgressBar.style.width = `${Math.min(100, overallAutomationProgress)}%`;
            overallAutomationProgressBar.className = `h-4 rounded-full ${getProgressBarColorClass(overallAutomationProgress)}`;
            overallAutomationProgressText.textContent = `${overallAutomationProgress.toFixed(1)}% Automated`;

            // Display warning if automated tests exceed planned tests overall
            if (totalCurrentlyAutomatedOverall > totalPlannedToAutomateOverall) {
                overallAutomationWarning.classList.remove('hidden');
            } else {
                overallAutomationWarning.classList.add('hidden');
            }
        }

        /**
         * Updates a single team's card with data and calculates its automation metrics.
         * @param {string} teamPrefix - The prefix for the team (e.g., 'Avengers').
         * @param {object} data - The complete data object.
         * @returns {object} An object containing the calculated total automated, planned, and total tests for this team.
         */
        function updateTeamCard(teamPrefix, data) {
            const lowerCaseTeamPrefix = teamPrefix.toLowerCase();

            let calculatedTeamAutomated = 0;
            let calculatedTeamPlannedToAutomate = 0;
            let calculatedTeamTotal = 0;

            const cardElement = document.getElementById(`${lowerCaseTeamPrefix}Card`);
            const testTypeBreakdownDiv = document.getElementById(`${lowerCaseTeamPrefix}TestTypeBreakdown`);
            const rollupWarningDiv = document.getElementById(`${lowerCaseTeamPrefix}RollupWarning`); // Keep reference to hide it

            // Clear previous breakdown content
            if (testTypeBreakdownDiv) {
                testTypeBreakdownDiv.innerHTML = '';
            }

            if (cardElement) {
                testTypeMetricPrefixes.forEach(testTypePrefix => {
                    const testTypeTotal = data[`${teamPrefix}_${testTypePrefix}_Total`] || 0;
                    const testTypePlannedToAutomate = data[`${teamPrefix}_${testTypePrefix}_PlannedToAutomate`] || 0;
                    const testTypeAutomated = data[`${teamPrefix}_${testTypePrefix}_Automated`] || 0;

                    calculatedTeamTotal += testTypeTotal;
                    calculatedTeamAutomated += testTypeAutomated;

                    // Exclude Functional Tests from PlannedToAutomate sum
                    if (testTypePrefix !== 'Functional') {
                        calculatedTeamPlannedToAutomate += testTypePlannedToAutomate;
                    }

                    const testTypeCoverage = testTypeTotal > 0 ? ((testTypeAutomated / testTypeTotal) * 100).toFixed(1) : 0;
                    const testTypeProgressBarColorClass = getProgressBarColorClass(testTypeCoverage);

                    if (testTypeBreakdownDiv) {
                        const div = document.createElement('div');
                        div.className = 'mb-1';

                        let plannedText = '';
                        if (testTypePrefix !== 'Functional') {
                            plannedText = ` / Planned: <span class="font-semibold">${testTypePlannedToAutomate.toLocaleString()}</span>`;
                        } else {
                            plannedText = ` / Planned: <span class="font-semibold">N/A</span>`; // Indicate not applicable for Functional
                        }

                        div.innerHTML = `
                            <span class="font-medium">${testTypeDisplayNames[testTypePrefix]}:</span> Total: <span class="font-semibold">${testTypeTotal.toLocaleString()}</span>${plannedText} / Automated: <span class="font-semibold">${testTypeAutomated.toLocaleString()}</span>
                            <div class="w-full bg-gray-200 rounded-full h-2 mt-1">
                                <div class="h-2 rounded-full ${testTypeProgressBarColorClass}" style="width: ${Math.min(100, testTypeCoverage)}%;"></div>
                            </div>
                            <p class="text-right text-xs text-gray-600 mt-0.5">${testTypeCoverage}% Automated</p>
                        `;
                        testTypeBreakdownDiv.appendChild(div);
                    }
                });

                // Update the team's main display elements with the calculated sums
                document.getElementById(`${lowerCaseTeamPrefix}Total`).textContent = calculatedTeamTotal.toLocaleString();
                document.getElementById(`${lowerCaseTeamPrefix}PlannedToAutomate`).textContent = calculatedTeamPlannedToAutomate.toLocaleString();
                document.getElementById(`${lowerCaseTeamPrefix}Automated`).textContent = calculatedTeamAutomated.toLocaleString();

                const teamAutomationCoverage = calculatedTeamPlannedToAutomate > 0 ? ((calculatedTeamAutomated / calculatedTeamPlannedToAutomate) * 100).toFixed(1) : 0;

                // Update team-level progress bar
                const teamAutomationProgressBar = cardElement.querySelector('.h-3.rounded-full');
                const teamAutomationProgressText = cardElement.querySelector('.text-right.text-sm.text-gray-600');

                if (teamAutomationProgressBar && teamAutomationProgressText) {
                    teamAutomationProgressBar.style.width = `${Math.min(100, teamAutomationCoverage)}%`;
                    teamAutomationProgressBar.className = `h-3 rounded-full ${getProgressBarColorClass(teamAutomationCoverage)}`;
                    teamAutomationProgressText.textContent = `${teamAutomationCoverage}% Automated`;
                }

                // Apply color coding for the team card based on calculated coverage
                cardElement.classList.remove(
                    'bg-green-50', 'border-green-200',
                    'bg-yellow-50', 'border-yellow-200',
                    'bg-red-50', 'border-red-200'
                );
                const { bgColorClass, borderColorClass } = getCardColorClasses(teamAutomationCoverage);
                cardElement.classList.add(bgColorClass, borderColorClass);

                // Hide the rollup warning as team totals are now calculated
                if (rollupWarningDiv) {
                    rollupWarningDiv.classList.add('hidden');
                }
            }
            return { calculatedAutomated: calculatedTeamAutomated, calculatedPlannedToAutomate: calculatedTeamPlannedToAutomate, calculatedTotal: calculatedTeamTotal };
        }

        /**
         * Validates the current dashboard state against expected metrics for a scenario.
         * @param {object} expectedMetrics - The expected values for overall and team metrics.
         * @param {object} actualData - The current data object applied to the dashboard.
         * @returns {boolean} True if all validations pass, false otherwise.
         */
        function validateScenario(expectedMetrics, actualData) {
            let allPassed = true;
            const tolerance = 0.1; // For floating point comparisons of percentages

            console.log("--- Starting Scenario Validation ---");

            // Validate Overall Automation Metrics
            const currentAutomatedCountElement = document.getElementById('currentAutomatedCount');
            const plannedAutomationCountElement = document.getElementById('plannedAutomationCount');
            const overallAutomationProgressElement = document.getElementById('overallAutomationProgressText');
            const overallAutomationWarning = document.getElementById('overallAutomationWarning');

            const currentAutomatedCount = parseInt(currentAutomatedCountElement.textContent.trim().replace(/\D/g, ''), 10);
            const plannedAutomationCount = parseInt(plannedAutomationCountElement.textContent.trim().replace(/\D/g, ''), 10);
            const overallAutomationProgress = parseFloat(overallAutomationProgressElement.textContent.trim().replace('% Automated', ''));
            const overallAutomationWarningVisible = !overallAutomationWarning.classList.contains('hidden');

            console.log("Overall Metrics - Expected vs Actual:");
            console.log(`  Current Automated: Expected=${expectedMetrics.overallAutomation.currentAutomatedCount}, Actual=${currentAutomatedCount}, Raw DOM Text: "${currentAutomatedCountElement.textContent.trim()}"`);
            console.log(`  Planned: Expected=${expectedMetrics.overallAutomation.plannedAutomationCount}, Actual=${plannedAutomationCount}, Raw DOM Text: "${plannedAutomationCountElement.textContent.trim()}"`);
            console.log(`  Progress: Expected=${expectedMetrics.overallAutomation.overallAutomationProgress}, Actual=${overallAutomationProgress}, Raw DOM Text: "${overallAutomationProgressElement.textContent.trim()}"`);
            console.log(`  Warning Visible: Expected=${expectedMetrics.overallAutomation.overallAutomationWarningVisible}, Actual=${overallAutomationWarningVisible}`);


            if (currentAutomatedCount !== expectedMetrics.overallAutomation.currentAutomatedCount ||
                plannedAutomationCount !== expectedMetrics.overallAutomation.plannedAutomationCount ||
                Math.abs(overallAutomationProgress - expectedMetrics.overallAutomation.overallAutomationProgress) > tolerance ||
                overallAutomationWarningVisible !== expectedMetrics.overallAutomation.overallAutomationWarningVisible) {
                allPassed = false;
                console.error("Overall automation validation FAILED.");
            } else {
                console.log("Overall automation validation PASSED.");
            }

            // Validate Team Metrics
            teamNames.forEach(team => {
                const lowerCaseTeamPrefix = team.prefix.toLowerCase();
                const expectedTeam = expectedMetrics.teams[team.prefix];

                if (!expectedTeam) {
                    console.warn(`No expected metrics found for team: ${team.prefix}. Skipping validation for this team.`);
                    return; // Skip validation for this team if no expected data
                }

                const actualTotalElement = document.getElementById(`${lowerCaseTeamPrefix}Total`);
                const actualAutomatedElement = document.getElementById(`${lowerCaseTeamPrefix}Automated`);
                const actualPlannedToAutomateElement = document.getElementById(`${lowerCaseTeamPrefix}PlannedToAutomate`);
                const actualAutomationProgressElement = document.querySelector(`#${lowerCaseTeamPrefix}Card .text-right.text-sm.text-gray-600`);
                const actualRollupWarningDiv = document.getElementById(`${lowerCaseTeamPrefix}RollupWarning`);


                // Use replace(/\D/g, '') to remove any non-digit characters (like thousands separators)
                const actualTotal = parseInt(actualTotalElement.textContent.trim().replace(/\D/g, ''), 10);
                const actualAutomated = parseInt(actualAutomatedElement.textContent.trim().replace(/\D/g, ''), 10);
                const actualPlannedToAutomate = parseInt(actualPlannedToAutomateElement.textContent.trim().replace(/\D/g, ''), 10);
                
                // For progress, it's a float, so keep the decimal point but remove % and trim
                const actualAutomationProgress = actualAutomationProgressElement ? parseFloat(actualAutomationProgressElement.textContent.trim().replace('% Automated', '')) : 0;

                const actualRollupWarningVisible = actualRollupWarningDiv ? !actualRollupWarningDiv.classList.contains('hidden') : false;

                // DEBUG: Log the actual value read from the DOM for validation
                console.log(`DEBUG: Team ${team.prefix} - Actual Automated (read from DOM for validation): ${actualAutomated}, Raw DOM Text: "${actualAutomatedElement.textContent.trim()}"`);

                console.log(`\nTeam ${team.prefix} Metrics - Expected vs Actual:`);
                console.log(`  Total Tests in Category: Expected=${expectedTeam.Total}, Actual=${actualTotal}, Match=${actualTotal === expectedTeam.Total}`);
                console.log(`  Tests Automated: Expected=${expectedTeam.Automated}, Actual=${actualAutomated}, Match=${actualAutomated === expectedTeam.Automated}`);
                console.log(`  Planned to Automate: Expected=${expectedTeam.PlannedToAutomate}, Actual=${actualPlannedToAutomate}, Match=${actualPlannedToAutomate === expectedTeam.PlannedToAutomate}`);
                console.log(`  Automation Progress %: Expected=${expectedTeam.AutomationProgress}, Actual=${actualAutomationProgress}, Diff=${Math.abs(actualAutomationProgress - expectedTeam.AutomationProgress).toFixed(2)}, Match=${Math.abs(actualAutomationProgress - expectedTeam.AutomationProgress) <= tolerance}`);
                console.log(`  Rollup Warning Visible: Expected=${expectedTeam.RollupWarningVisible}, Actual=${actualRollupWarningVisible}, Match=${actualRollupWarningVisible === expectedTeam.RollupWarningVisible}`);


                if (actualTotal !== expectedTeam.Total ||
                    actualAutomated !== expectedTeam.Automated ||
                    actualPlannedToAutomate !== expectedTeam.PlannedToAutomate ||
                    Math.abs(actualAutomationProgress - expectedTeam.AutomationProgress) > tolerance ||
                    actualRollupWarningVisible !== expectedTeam.RollupWarningVisible) {
                    allPassed = false;
                    console.error(`Validation FAILED for team: ${team.prefix}`);
                } else {
                    console.log(`Validation PASSED for team: ${team.prefix}`);
                }
            });

            console.log("--- Scenario Validation Finished ---");
            return allPassed; // Return the overall result
        }


        /**
         * Copies text to the clipboard and shows a temporary confirmation message.
         * @param {string} text - The text to copy.
         */
        function copyTextToClipboard(text) {
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = text.trim();
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy'); // Deprecated but widely supported for iframes
            document.body.removeChild(tempTextArea);

            showConfirmation('Copied!'); // Use the global showConfirmation for "Copied!" message
        }
    </script>
</body>
</html>
